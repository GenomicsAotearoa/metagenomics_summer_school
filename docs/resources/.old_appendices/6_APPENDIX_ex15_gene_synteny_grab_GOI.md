# APPENDIX (ex15): Grab Gene of Interest (generate the *cys.txt* files provided in [ex15_gene_synteny](https://github.com/GenomicsAotearoa/metagenomics_summer_school/blob/master/materials/day4/ex16e_data_presentation_Gene_synteny.md))

Below is the example documentation for how the files of genes that we were interested in (`*cys.txt` files) were generated. 

Load annotation files in R and find genes of interest. 

```R
setwd('path/to/input/files')

library("readr")
library("dplyr")
library("tidyr")

dataFiles <- lapply(Sys.glob("*.aa"), read.delim,sep = "\t")
```

Here, we are looking for the gene cluster that consists of *sbp* (sulfur binding protein) and *cysUWA* using KEGG databases (thier KO numbers are: K02048,K02046,K02047,K02045)

```R
GOI_4 <- data.frame()
GOI_5 <- data.frame()
GOI_7 <- data.frame()

for (keggid in c("K02048","K02046","K02047","K02045")) {
    GOI_4 <- rbind(GOI_4,dataFiles[[1]][grep(keggid,dataFiles[[1]]$Description.2),])
    GOI_5 <- rbind(GOI_5,dataFiles[[2]][grep(keggid,dataFiles[[2]]$Description.2),])
    GOI_7 <- rbind(GOI_7,dataFiles[[3]][grep(keggid,dataFiles[[3]]$Description.2),])}
GOI_4
```

<table>
<caption>A data.frame: 4 × 33</caption>
<thead>
	<tr><th></th><th scope=col>Query.Gene</th><th scope=col>GC.</th><th scope=col>Contig.name</th><th scope=col>Start.position</th><th scope=col>Stop.position</th><th scope=col>Orientation</th><th scope=col>Query.sequence</th><th scope=col>Signalling</th><th scope=col>Signal.confidence</th><th scope=col>Target.gene..UniProt.</th><th scope=col>⋯</th><th scope=col>Coverage.2</th><th scope=col>E.value.2</th><th scope=col>Description.2</th><th scope=col>Taxonomy.2</th><th scope=col>Target.gene..Pfam.</th><th scope=col>E.value.3</th><th scope=col>Description.3</th><th scope=col>Target.gene..TIGRfam.</th><th scope=col>E.value.4</th><th scope=col>Description.4</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>⋯</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1433</th><td>bin_4_NODE_55_length_158395_cov_1.135272_128</td><td>49.90</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MKFNIWLSVGLLTFALAGASQAFADRTLLNVSYDPTRELYEEYNREFIRYWQEKTGEKITVKQSHGGSGKQARAVIDGVPADIVTLALAHDIDAISEQSGLIPAEWQKRLPNNSSPYLSTIVLLVRKDNPKGIRDWDDLIKPGVAVITPNPKTSGGARWNYLAAWGFALKKYDGDEAKAQEFLTRLYKNVSILDSGARGSTINFIQRGIGDVLISWENEAFLALKEYGPEKFEIIIPSISILAEPPVAVVDKNVDKHGVRNIAQAYLEYLYDKKGQEIAARNFYRPSDPEIAKKYAHQFPAINLFTINEVFGGWPQAQSIHFKDGGLFDKIYVNQ*                           </td><td>-</td><td>-</td><td>A0A1H9YF74</td><td>⋯</td><td>99.701493</td><td>-1.000000</td><td>K02048: sbp1; Prokaryotic sulfate-/thiosulfate-binding protein           </td><td>Nitrosomonas europaea</td><td>PF12849.7; PF01547.25; PF13531.6; PF13343.6                                                                                                        </td><td>0.000200; 0.000000; 0.000000; 0.000000                                                                                          </td><td>PBP_like_2; SBP_bac_1; SBP_bac_11; SBP_bac_6                                                            </td><td>TIGR00971; TIGR03261                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td><td>0.000000; 0.000001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td><td>TIGR00971; TIGR03261                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr>
	<tr><th scope=row>1600</th><td>bin_4_NODE_55_length_158395_cov_1.135272_132</td><td>52.88</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MSTFKQYSVLPGFNLALGFTLLYLSLVVLIPLSAAFIHSAKLTWPEFWSTVTAPRVVASYRLTFGASFAAAVVNTFFGLLVAWVLVRYPFPGKRLVDALIDLPFALPTSVAGITLTAIYAGNGWLGQYLEPLGIKVAFTPVGVFVALTFIGLPFVVRTVQPVLEDIEKELEEAAAMLGATRWQTFRYVIFPAVLPALTTGFALAFARAIGEYGSVIFIAGNIPMVSEITPLLIITKLEQYDYAGATAIAVVMLVISFILLLIINLLQWWVRHRSIKA*                                                                                     </td><td>-</td><td>-</td><td>A0A1H9YF01</td><td>⋯</td><td>99.638989</td><td>-1.000000</td><td>K02046: cysU; cysU; sulfate transport ABC transporter protein            </td><td>Nitrosomonas europaea</td><td>PF00528.22                                                                                                                                         </td><td>0.000000                                                                                                                        </td><td>BPD_transp_1                                                                                            </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262; TIGR03416                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td>0.000000; 0.000000; 0.000001; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000220                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262; TIGR03416                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr>
	<tr><th scope=row>1599</th><td>bin_4_NODE_55_length_158395_cov_1.135272_133</td><td>54.27</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MTAVPLLQTSPAPHKVVTQESPWARWTLILLALSFLSLFLLLPLVAVFFEALRKGWEVYLAAITEPDALAAIRLTLIAAAIAVPLNLIFGIAAAWAIAKFEFRGKSILTSLIDLPFSVSPVVAGLIYVLIFGLQGWIGPWLREHDLSIIFAVPGIVLATIFVTVPFIARELIPLMQAQGSEEEEAAIILGASGWQTLWYVTLPNIKWGLLYGTILCNARAMGEFGAVSVVSGHIRGLTNTLSLHVEILYNEYNFVAAFAVASLLALLALITLVLKTLVEAKVAQQTSRGNHS*                                                                      </td><td>-</td><td>-</td><td>A0A1H9YF25</td><td>⋯</td><td>99.657534</td><td>-1.000000</td><td>K02047: cysW; cysW; sulfate transport ABC transporter protein            </td><td>Nitrosomonas europaea</td><td>PF00528.22                                                                                                                                         </td><td>0.000000                                                                                                                        </td><td>BPD_transp_1                                                                                            </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td><td>0.000000; 0.000000; 0.000420; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000019; 0.000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr>
	<tr><th scope=row>1606</th><td>bin_4_NODE_55_length_158395_cov_1.135272_134</td><td>53.35</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MTIEIHDLSKQFGSFTALNDINLKVNPGELLALLGPSGSGKTTLLRVIAGLETADSGQVLFNEEDSTDKHIRDRHVGFVFQHYALFRNMTIFENVAFGLRVRPRKQRPNAPEINHRVTELLQLVQLDWLADRYPHQLSGGQRQRIALARALAVEPSVLLLDEPFGALDAKVRKELRAWLRKLHDDMHITSVFVTHDQEEALEVADRIVVMNRGRIEQIGTPDEVYEKPANPFVYEFLGHVNLFHGRVHQGHAWIGDLEVDAPEYSEAEDLSAIAYVRPHDIEVDRTLNGEPALAAHIVHILAIGPVVRLELAGKDNQSTNSIYAEISKERFRELQLARGDQVFIKPRKLDLFPNHAQNGSIH*</td><td>-</td><td>-</td><td>Q82WT5    </td><td>⋯</td><td>99.723757</td><td>-1.000000</td><td>K02045: cysA; cysA; sulfate transport ATP-binding ABC transporter protein</td><td>Nitrosomonas europaea</td><td>PF00004.29; PF13191.6; PF13304.6; PF13401.6; PF13476.6; PF13555.6; PF00005.27; PF17850.1; PF05729.12; PF02463.19; PF05621.11; PF03459.17; PF12857.7</td><td>0.000500; 0.000035; 0.000000; 0.000150; 0.000200; 0.000096; 0.000000; 0.000000; 0.000930; 0.000000; 0.000770; 0.000009; 0.000000</td><td>AAA; AAA_16; AAA_21; AAA_22; AAA_23; AAA_29; ABC_tran; CysA_C_terminal; NACHT; SMC_N; TniB; TOBE; TOBE_3</td><td>TIGR00611; TIGR00630; TIGR00954; TIGR00955; TIGR00956; TIGR00957; TIGR00958; TIGR00968; TIGR00972; TIGR01166; TIGR01184; TIGR01186; TIGR01187; TIGR01188; TIGR01189; TIGR01192; TIGR01193; TIGR01194; TIGR01257; TIGR01271; TIGR01277; TIGR01288; TIGR01842; TIGR01846; TIGR01978; TIGR02142; TIGR02203; TIGR02204; TIGR02211; TIGR02314; TIGR02315; TIGR02323; TIGR02324; TIGR02633; TIGR02673; TIGR02769; TIGR02770; TIGR02857; TIGR02868; TIGR02982; TIGR03005; TIGR03258; TIGR03265; TIGR03269; TIGR03375; TIGR03410; TIGR03411; TIGR03415; TIGR03522; TIGR03608; TIGR03719; TIGR03740; TIGR03771; TIGR03796; TIGR03797; TIGR03864; TIGR03873; TIGR04406</td><td>0.000020; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000</td><td>TIGR00611; TIGR00630; TIGR00954; TIGR00955; TIGR00956; TIGR00957; TIGR00958; TIGR00968; TIGR00972; TIGR01166; TIGR01184; TIGR01186; TIGR01187; TIGR01188; TIGR01189; TIGR01192; TIGR01193; TIGR01194; TIGR01257; TIGR01271; TIGR01277; TIGR01288; TIGR01842; TIGR01846; TIGR01978; TIGR02142; TIGR02203; TIGR02204; TIGR02211; TIGR02314; TIGR02315; TIGR02323; TIGR02324; TIGR02633; TIGR02673; TIGR02769; TIGR02770; TIGR02857; TIGR02868; TIGR02982; TIGR03005; TIGR03258; TIGR03265; TIGR03269; TIGR03375; TIGR03410; TIGR03411; TIGR03415; TIGR03522; TIGR03608; TIGR03719; TIGR03740; TIGR03771; TIGR03796; TIGR03797; TIGR03864; TIGR03873; TIGR04406</td></tr>
</tbody>
</table>

As bin_4 has additional unknown genes in between the sulfur assimilation gene cluster, we will manually add them into the dataframe by looking in the .aa file (protein sequence bin_4_NODE_55_length_158395_cov_1.135272_129, bin_4_NODE_55_length_158395_cov_1.135272_130 and bin_4_NODE_55_length_158395_cov_1.135272_131).

```R
for (bin_node in c("bin_4_NODE_55_length_158395_cov_1.135272_129","bin_4_NODE_55_length_158395_cov_1.135272_130","bin_4_NODE_55_length_158395_cov_1.135272_131")) {
        GOI_4 <- rbind(GOI_4,dataFiles[[1]][grep(bin_node,dataFiles[[1]]$Query.Gene),])}

(GOI_4)
```

<table>
<caption>A data.frame: 7 × 33</caption>
<thead>
	<tr><th></th><th scope=col>Query.Gene</th><th scope=col>GC.</th><th scope=col>Contig.name</th><th scope=col>Start.position</th><th scope=col>Stop.position</th><th scope=col>Orientation</th><th scope=col>Query.sequence</th><th scope=col>Signalling</th><th scope=col>Signal.confidence</th><th scope=col>Target.gene..UniProt.</th><th scope=col>⋯</th><th scope=col>Coverage.2</th><th scope=col>E.value.2</th><th scope=col>Description.2</th><th scope=col>Taxonomy.2</th><th scope=col>Target.gene..Pfam.</th><th scope=col>E.value.3</th><th scope=col>Description.3</th><th scope=col>Target.gene..TIGRfam.</th><th scope=col>E.value.4</th><th scope=col>Description.4</th></tr>
	<tr><th></th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>⋯</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1433</th><td>bin_4_NODE_55_length_158395_cov_1.135272_128</td><td>49.90</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MKFNIWLSVGLLTFALAGASQAFADRTLLNVSYDPTRELYEEYNREFIRYWQEKTGEKITVKQSHGGSGKQARAVIDGVPADIVTLALAHDIDAISEQSGLIPAEWQKRLPNNSSPYLSTIVLLVRKDNPKGIRDWDDLIKPGVAVITPNPKTSGGARWNYLAAWGFALKKYDGDEAKAQEFLTRLYKNVSILDSGARGSTINFIQRGIGDVLISWENEAFLALKEYGPEKFEIIIPSISILAEPPVAVVDKNVDKHGVRNIAQAYLEYLYDKKGQEIAARNFYRPSDPEIAKKYAHQFPAINLFTINEVFGGWPQAQSIHFKDGGLFDKIYVNQ*                           </td><td>-</td><td>-</td><td>A0A1H9YF74</td><td>⋯</td><td>99.701493</td><td>-1.000000</td><td>K02048: sbp1; Prokaryotic sulfate-/thiosulfate-binding protein           </td><td>Nitrosomonas europaea</td><td>PF12849.7; PF01547.25; PF13531.6; PF13343.6                                                                                                        </td><td>0.000200; 0.000000; 0.000000; 0.000000                                                                                          </td><td>PBP_like_2; SBP_bac_1; SBP_bac_11; SBP_bac_6                                                            </td><td>TIGR00971; TIGR03261                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td><td>0.000000; 0.000001                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                </td><td>TIGR00971; TIGR03261                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </td></tr>
	<tr><th scope=row>1600</th><td>bin_4_NODE_55_length_158395_cov_1.135272_132</td><td>52.88</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MSTFKQYSVLPGFNLALGFTLLYLSLVVLIPLSAAFIHSAKLTWPEFWSTVTAPRVVASYRLTFGASFAAAVVNTFFGLLVAWVLVRYPFPGKRLVDALIDLPFALPTSVAGITLTAIYAGNGWLGQYLEPLGIKVAFTPVGVFVALTFIGLPFVVRTVQPVLEDIEKELEEAAAMLGATRWQTFRYVIFPAVLPALTTGFALAFARAIGEYGSVIFIAGNIPMVSEITPLLIITKLEQYDYAGATAIAVVMLVISFILLLIINLLQWWVRHRSIKA*                                                                                     </td><td>-</td><td>-</td><td>A0A1H9YF01</td><td>⋯</td><td>99.638989</td><td>-1.000000</td><td>K02046: cysU; cysU; sulfate transport ABC transporter protein            </td><td>Nitrosomonas europaea</td><td>PF00528.22                                                                                                                                         </td><td>0.000000                                                                                                                        </td><td>BPD_transp_1                                                                                            </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262; TIGR03416                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td>0.000000; 0.000000; 0.000001; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000220                                                                                                                                                                                                                                                                                                                                                                                                                                                                  </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262; TIGR03416                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td></tr>
	<tr><th scope=row>1599</th><td>bin_4_NODE_55_length_158395_cov_1.135272_133</td><td>54.27</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MTAVPLLQTSPAPHKVVTQESPWARWTLILLALSFLSLFLLLPLVAVFFEALRKGWEVYLAAITEPDALAAIRLTLIAAAIAVPLNLIFGIAAAWAIAKFEFRGKSILTSLIDLPFSVSPVVAGLIYVLIFGLQGWIGPWLREHDLSIIFAVPGIVLATIFVTVPFIARELIPLMQAQGSEEEEAAIILGASGWQTLWYVTLPNIKWGLLYGTILCNARAMGEFGAVSVVSGHIRGLTNTLSLHVEILYNEYNFVAAFAVASLLALLALITLVLKTLVEAKVAQQTSRGNHS*                                                                      </td><td>-</td><td>-</td><td>A0A1H9YF25</td><td>⋯</td><td>99.657534</td><td>-1.000000</td><td>K02047: cysW; cysW; sulfate transport ABC transporter protein            </td><td>Nitrosomonas europaea</td><td>PF00528.22                                                                                                                                         </td><td>0.000000                                                                                                                        </td><td>BPD_transp_1                                                                                            </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td><td>0.000000; 0.000000; 0.000420; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000019; 0.000000                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </td><td>TIGR00969; TIGR00974; TIGR01097; TIGR01253; TIGR01581; TIGR02138; TIGR02139; TIGR02140; TIGR02141; TIGR03226; TIGR03255; TIGR03262                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          </td></tr>
	<tr><th scope=row>1606</th><td>bin_4_NODE_55_length_158395_cov_1.135272_134</td><td>53.35</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MTIEIHDLSKQFGSFTALNDINLKVNPGELLALLGPSGSGKTTLLRVIAGLETADSGQVLFNEEDSTDKHIRDRHVGFVFQHYALFRNMTIFENVAFGLRVRPRKQRPNAPEINHRVTELLQLVQLDWLADRYPHQLSGGQRQRIALARALAVEPSVLLLDEPFGALDAKVRKELRAWLRKLHDDMHITSVFVTHDQEEALEVADRIVVMNRGRIEQIGTPDEVYEKPANPFVYEFLGHVNLFHGRVHQGHAWIGDLEVDAPEYSEAEDLSAIAYVRPHDIEVDRTLNGEPALAAHIVHILAIGPVVRLELAGKDNQSTNSIYAEISKERFRELQLARGDQVFIKPRKLDLFPNHAQNGSIH*</td><td>-</td><td>-</td><td>Q82WT5    </td><td>⋯</td><td>99.723757</td><td>-1.000000</td><td>K02045: cysA; cysA; sulfate transport ATP-binding ABC transporter protein</td><td>Nitrosomonas europaea</td><td>PF00004.29; PF13191.6; PF13304.6; PF13401.6; PF13476.6; PF13555.6; PF00005.27; PF17850.1; PF05729.12; PF02463.19; PF05621.11; PF03459.17; PF12857.7</td><td>0.000500; 0.000035; 0.000000; 0.000150; 0.000200; 0.000096; 0.000000; 0.000000; 0.000930; 0.000000; 0.000770; 0.000009; 0.000000</td><td>AAA; AAA_16; AAA_21; AAA_22; AAA_23; AAA_29; ABC_tran; CysA_C_terminal; NACHT; SMC_N; TniB; TOBE; TOBE_3</td><td>TIGR00611; TIGR00630; TIGR00954; TIGR00955; TIGR00956; TIGR00957; TIGR00958; TIGR00968; TIGR00972; TIGR01166; TIGR01184; TIGR01186; TIGR01187; TIGR01188; TIGR01189; TIGR01192; TIGR01193; TIGR01194; TIGR01257; TIGR01271; TIGR01277; TIGR01288; TIGR01842; TIGR01846; TIGR01978; TIGR02142; TIGR02203; TIGR02204; TIGR02211; TIGR02314; TIGR02315; TIGR02323; TIGR02324; TIGR02633; TIGR02673; TIGR02769; TIGR02770; TIGR02857; TIGR02868; TIGR02982; TIGR03005; TIGR03258; TIGR03265; TIGR03269; TIGR03375; TIGR03410; TIGR03411; TIGR03415; TIGR03522; TIGR03608; TIGR03719; TIGR03740; TIGR03771; TIGR03796; TIGR03797; TIGR03864; TIGR03873; TIGR04406</td><td>0.000020; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000; 0.000000</td><td>TIGR00611; TIGR00630; TIGR00954; TIGR00955; TIGR00956; TIGR00957; TIGR00958; TIGR00968; TIGR00972; TIGR01166; TIGR01184; TIGR01186; TIGR01187; TIGR01188; TIGR01189; TIGR01192; TIGR01193; TIGR01194; TIGR01257; TIGR01271; TIGR01277; TIGR01288; TIGR01842; TIGR01846; TIGR01978; TIGR02142; TIGR02203; TIGR02204; TIGR02211; TIGR02314; TIGR02315; TIGR02323; TIGR02324; TIGR02633; TIGR02673; TIGR02769; TIGR02770; TIGR02857; TIGR02868; TIGR02982; TIGR03005; TIGR03258; TIGR03265; TIGR03269; TIGR03375; TIGR03410; TIGR03411; TIGR03415; TIGR03522; TIGR03608; TIGR03719; TIGR03740; TIGR03771; TIGR03796; TIGR03797; TIGR03864; TIGR03873; TIGR04406</td></tr>
	<tr><th scope=row>1434</th><td>bin_4_NODE_55_length_158395_cov_1.135272_129</td><td>46.41</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MTVLIVGGDYIASLKQRITAHGYSRIEHWNGRKKGFNKRALPGRTKLVVIIYDYVSHNLANSVKDQASRIGIPMIFCRHAMHEIDTIFDEKKAEESCCNFV*                                                                                                                                                                                                                                                                     </td><td>-</td><td>-</td><td>A0A1H9YF98</td><td>⋯</td><td>99.009901</td><td>-1.000000</td><td>possible predicted diverged CheY-domain                                  </td><td>Nitrosomonas europaea</td><td>PF10087.9                                                                                                                                          </td><td>0.000000                                                                                                                        </td><td>DUF2325                                                                                                 </td><td>Not annotated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td>-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td><td>-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr>
	<tr><th scope=row>1602</th><td>bin_4_NODE_55_length_158395_cov_1.135272_130</td><td>44.85</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MLPSTLKTLVHGDYMIRTIERIITSTGFSLQHSDNGEITGLFYHCKLSSAYQPVFEAARNNIIGQEARIRADLNGNGEIQLSPWHIFALAPDDEQLIKLDRLCRTIHALNFLDNITNKQMKLFVSVQPRLLESVKDDHGSAFEQILDIIGIRTSRIVIEIPVEANRDWRLLKRVIMNYRAHGYLISVNYSGTNNDRISELGKLYPNVIRIDARDLLRRSVLDPLIVTAHNQGADVLVGNIETSYQLTDAIHAGADLLQGNFLARYSRKADNMLTPFSWQIPDERNGYRFDNESLQENQPYRSI*                                                           </td><td>-</td><td>-</td><td>A0A1H9YFC5</td><td>⋯</td><td>99.653979</td><td>-1.000000</td><td>Domain of unknown function 2                                             </td><td>Nitrosomonas europaea</td><td>PF00563.20                                                                                                                                         </td><td>0.000000                                                                                                                        </td><td>EAL                                                                                                     </td><td>Not annotated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td>-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td><td>-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr>
	<tr><th scope=row>1601</th><td>bin_4_NODE_55_length_158395_cov_1.135272_131</td><td>46.51</td><td>bin_4_NODE_55_length_158395_cov_1.135272</td><td>0</td><td>0</td><td>Reverse</td><td>MNRTTAKPFTVMDEFELIKAATDYSLEQDENGRISGNFYHCKLTSAFQVILDIHENNIIGHAAYIRSESNGEVSLWPWQVFALASKDEQLIDLDRLCRAIHALNYFKKNFDTNTGQLFLSVHPRLLSSIQNEHGRTFKDFLDLTGISTSRIVIEIPPALNHDWKLLQKLIINYRSYGYQIALNFSSTNGHWLLGTDDLHPDILIVQAHELLHYQLNDYPEDNSTRDAGFRLHVRKIETQEQLTAAKQAGAHYLQGNFLGKTV*                                                                                                    </td><td>-</td><td>-</td><td>A0A1H9YEZ8</td><td>⋯</td><td>99.618321</td><td>-1.000000</td><td>Domain of unknown function 2                                             </td><td>Nitrosomonas europaea</td><td>PF00563.20                                                                                                                                         </td><td>0.000000                                                                                                                        </td><td>EAL                                                                                                     </td><td>Not annotated                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               </td><td>-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </td><td>-                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           </td></tr>
</tbody>
</table>


We found 2 genes match to K02048 for bin 5: the sulfate binding protein, but as we are only interested at the gene cluster, we will look at the one from the same contig as the other genes. Next, we will create the tables (`*cys.txt`) to be used for 'genoPlotR'.


```R
GOI4=GOI_4[1:7,] %>%  
    select("Description.2","Query.Gene") %>% 
    separate(col = Description.2, into = c("KO", "Annotation"), sep = ":") 
GOI5=GOI_5[c(1,3:5),] %>%  
    select("Description.2","Query.Gene") %>% 
    separate(col = Description.2, into = c("KO", "Annotation"), sep = ":") 
GOI7=GOI_7[1:4,] %>%  
    select("Description.2","Query.Gene") %>% 
    separate(col = Description.2, into = c("KO", "Annotation"), sep = ":") 

rownames(GOI4) <- c() 
rownames(GOI5) <- c() 
rownames(GOI7) <- c() 
 
head(GOI4)
```

    Warning message:
    “Expected 2 pieces. Missing pieces filled with `NA` in 3 rows [5, 6, 7].”


<table>
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th scope=col>KO</th><th scope=col>Annotation</th><th scope=col>Query.Gene</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>K02048                                 </td><td> sbp1; Prokaryotic sulfate-/thiosulfate-binding protein           </td><td>bin_4_NODE_55_length_158395_cov_1.135272_128</td></tr>
	<tr><td>K02046                                 </td><td> cysU; cysU; sulfate transport ABC transporter protein            </td><td>bin_4_NODE_55_length_158395_cov_1.135272_132</td></tr>
	<tr><td>K02047                                 </td><td> cysW; cysW; sulfate transport ABC transporter protein            </td><td>bin_4_NODE_55_length_158395_cov_1.135272_133</td></tr>
	<tr><td>K02045                                 </td><td> cysA; cysA; sulfate transport ATP-binding ABC transporter protein</td><td>bin_4_NODE_55_length_158395_cov_1.135272_134</td></tr>
	<tr><td>possible predicted diverged CheY-domain</td><td>NA                                                                </td><td>bin_4_NODE_55_length_158395_cov_1.135272_129</td></tr>
	<tr><td>Domain of unknown function 2           </td><td>NA                                                                </td><td>bin_4_NODE_55_length_158395_cov_1.135272_130</td></tr>
</tbody>
</table>


Edit the gene annotation for the unknown KO in bin_4 to get the table below

```R
GOI4 = mutate(GOI4, Annotation = case_when(Annotation == "NA" ~ "",TRUE ~ as.character(KO)))
GOI4
```


<table>
<caption>A data.frame: 7 × 3</caption>
<thead>
	<tr><th scope=col>KO</th><th scope=col>Annotation</th><th scope=col>Query.Gene</th></tr>
	<tr><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;fct&gt;</th></tr>
</thead>
<tbody>
	<tr><td>K02048                                 </td><td>K02048                                 </td><td>bin_4_NODE_55_length_158395_cov_1.135272_128</td></tr>
	<tr><td>K02046                                 </td><td>K02046                                 </td><td>bin_4_NODE_55_length_158395_cov_1.135272_132</td></tr>
	<tr><td>K02047                                 </td><td>K02047                                 </td><td>bin_4_NODE_55_length_158395_cov_1.135272_133</td></tr>
	<tr><td>K02045                                 </td><td>K02045                                 </td><td>bin_4_NODE_55_length_158395_cov_1.135272_134</td></tr>
	<tr><td>possible predicted diverged CheY-domain</td><td>possible predicted diverged CheY-domain</td><td>bin_4_NODE_55_length_158395_cov_1.135272_129</td></tr>
	<tr><td>Domain of unknown function 2           </td><td>Domain of unknown function 2           </td><td>bin_4_NODE_55_length_158395_cov_1.135272_130</td></tr>
	<tr><td>Domain of unknown function 2           </td><td>Domain of unknown function 2           </td><td>bin_4_NODE_55_length_158395_cov_1.135272_131</td></tr>
</tbody>
</table>

Export the files. 

```R
write_delim(GOI4, "bin_4_cys.txt", delim="\t")
write_delim(GOI5, "bin_5_cys.txt", delim="\t")
write_delim(GOI7, "bin_7_cys.txt", delim="\t")
```
