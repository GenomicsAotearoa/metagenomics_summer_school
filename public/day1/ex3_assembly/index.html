
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Genomics Aotearoa &amp; NeSI" name="author"/>
<link href="https://genomicsaotearoa.github.io/metagenomics_summer_school/day1/ex3_assembly/" rel="canonical"/>
<link href="../ex2_quality_filtering/" rel="prev"/>
<link href="../ex4_assembly/" rel="next"/>
<link href="../../theme_images/nesi_ga.png" rel="icon"/>
<meta content="mkdocs-1.4.3, mkdocs-material-9.1.15" name="generator"/>
<title>Assembly I: Assembling contigs - Metagenomics Summer School</title>
<link href="../../assets/stylesheets/main.26e3688c.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.ecc896b0.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Mukta:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Mukta";--md-code-font:"Roboto Mono"}</style>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#assembly-i-assembling-contigs">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Metagenomics Summer School" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Metagenomics Summer School">
<img alt="logo" src="../../theme_images/nesi_ga.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Metagenomics Summer School
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Assembly I: Assembling contigs
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_3" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_3" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/GenomicsAotearoa/metagenomics_summer_school" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GenomicsAotearoa/metagenomics_summer_school
  </div>
</a>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../ex1_bash_and_scheduler/">
        Day 1
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../day2/ex6_initial_binning/">
        Day 2
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../day3/ex11_coverage_and_taxonomy/">
        Day 3
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../day4/ex15_gene_annotation_part3/">
        Day 4
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../resources/1_APPENDIX_ex8_Dereplication/">
        Resources
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../supplementary/supplementary_1/">
        Supplementary
      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Metagenomics Summer School" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Metagenomics Summer School">
<img alt="logo" src="../../theme_images/nesi_ga.png"/>
</a>
    Metagenomics Summer School
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/GenomicsAotearoa/metagenomics_summer_school" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
</div>
<div class="md-source__repository">
    GenomicsAotearoa/metagenomics_summer_school
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Day 1
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Day 1
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../ex1_bash_and_scheduler/">
        Introduction I: Shell
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ex2_1_intro_to_scheduler/">
        Introduction II: HPC and job scheduler
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ex2_quality_filtering/">
        Filter raw reads by quality
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Assembly I: Assembling contigs
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Assembly I: Assembling contigs
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-standard-input-files-for-spades-and-idba-ud">
    The standard input files for SPAdes and IDBA-UD
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-assembly-parameters">
    Basic assembly parameters
  </a>
<nav aria-label="Basic assembly parameters" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-the-k-mer-size">
    Setting the k-mer size
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#specifying-the-number-of-threads">
    Specifying the number of threads
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-a-memory-limit">
    Setting a memory limit
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#preparing-an-assembly-job-for-slurm">
    Preparing an assembly job for slurm
  </a>
<nav aria-label="Preparing an assembly job for slurm" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#submitting-a-spades-job-to-nesi-using-slurm">
    Submitting a SPAdes job to NeSI using slurm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monitoring-job-progress">
    Monitoring job progress
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#submitting-an-idba-ud-job-to-nesi-using-slurm">
    Submitting an IDBA-UD job to NeSI using slurm
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ex4_assembly/">
        Assembly II: Varying the parameters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ex5_evaluating_assemblies/">
        Assembly evaluation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Day 2
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Day 2
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../day2/ex6_initial_binning/">
        Introduction to binning
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day2/ex7_initial_binning/">
        Binning with multiple tools
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day2/ex8_bin_dereplication/">
        Bin dereplication
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day2/ex9_refining_bins/">
        Manual bin refinement
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Day 3
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Day 3
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../day3/ex11_coverage_and_taxonomy/">
        Assigning taxonomy to refined prokaryotic bins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day3/ex11.1_phylogenomics/">
        Phylogenomics
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day3/ex10_viruses/">
        Identifying viral contigs in metagenomic data
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day3/ex12_gene_prediction/">
        Gene prediction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day3/ex13_gene_annotation_part1/">
        Gene annotation I: BLAST-like and HMM
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day3/ex14_gene_annotation_part2/">
        Gene annotation II: DRAM and coverage calculation
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Day 4
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Day 4
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex15_gene_annotation_part3/">
        Gene annotation III: DRAM distillation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex16a_data_presentation_Intro/">
        Introduction to data presentation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex16b_data_presentation_Coverage/">
        Coverage heatmaps
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex16c_OPTIONAL_data_presentation_Ordination/">
        Ordinations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex16d_data_presentation_KEGG_pathways/">
        KEGG pathway maps
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex16e_data_presentation_Gene_synteny/">
        Gene synteny
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../day4/ex16f_OPTIONAL_data_presentation_CAZy_annotations/">
        CAZy heatmaps
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Resources
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Resources
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/1_APPENDIX_ex8_Dereplication/">
        APPENDIX (ex8): Dereplicating data from multiple assemblies
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/2_APPENDIX_ex9_Generating_input_files_for_VizBin/">
        APPENDIX (ex9): Generating input files for *VizBin* from *DAS_Tool* curated bins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/3_APPENDIX_ex11_Normalise_coverage_example/">
        APPENDIX (ex11): Normalise per-sample coverage values by average library size (example)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/4_APPENDIX_ex11_viral_taxonomy_prediction_via_vContact2/">
        APPENDIX (ex11) : Viral taxonomy prediction via *vContact2*
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/5_APPENDIX_ex15_Prepare_gene_synteny_inputs/">
        APPENDIX (ex15): Prepare input for gene synteny visualisation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/5_APPENDIX_ex15_gene_synteny_Generate_blast_files/">
        APPENDIX (ex15): Generating pairwise contig comparisons using online BLAST
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../resources/7_command_line_shortcuts/">
        Useful command line shortcuts
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Supplementary
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          Supplementary
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../supplementary/supplementary_1/">
        NeSI Setup
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../supplementary/supplementary_2/">
        NeSI File system, Working directory and Symlinks
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-standard-input-files-for-spades-and-idba-ud">
    The standard input files for SPAdes and IDBA-UD
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-assembly-parameters">
    Basic assembly parameters
  </a>
<nav aria-label="Basic assembly parameters" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-the-k-mer-size">
    Setting the k-mer size
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#specifying-the-number-of-threads">
    Specifying the number of threads
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#setting-a-memory-limit">
    Setting a memory limit
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#preparing-an-assembly-job-for-slurm">
    Preparing an assembly job for slurm
  </a>
<nav aria-label="Preparing an assembly job for slurm" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#submitting-a-spades-job-to-nesi-using-slurm">
    Submitting a SPAdes job to NeSI using slurm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monitoring-job-progress">
    Monitoring job progress
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#submitting-an-idba-ud-job-to-nesi-using-slurm">
    Submitting an IDBA-UD job to NeSI using slurm
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="assembly-i-assembling-contigs">Assembly I: Assembling contigs<a class="headerlink" href="#assembly-i-assembling-contigs" title="Permanent link">¶</a></h1>
<div class="admonition info">
<p class="admonition-title">Objectives</p>
<ul>
<li><a href="#the-standard-input-files-for-spades-and-idba-ud">Become familiar with the standard input files for <code>SPAdes</code> and <code>IDBA-UD</code></a></li>
<li><a href="#basic-assembly-parameters">Understand the basic parameters that should be modified when using these assemblers</a></li>
<li><a href="#preparing-an-assembly-job-for-slurm">Prepare an assembly job to run under slurm</a></li>
</ul>
</div>
<p><center>
<a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../../theme_images/genome_assembly.png"><img alt="image" src="../../theme_images/genome_assembly.png" width="450"/></a>
</center></p>
<p>All work for this exercise will occur in the <code>3.assembly/</code> directory.</p>
<hr/>
<h2 id="the-standard-input-files-for-spades-and-idba-ud">The standard input files for <code>SPAdes</code> and <code>IDBA-UD</code><a class="headerlink" href="#the-standard-input-files-for-spades-and-idba-ud" title="Permanent link">¶</a></h2>
<p>Although they both make use of the same types of data, both <code>SPAdes</code> and <code>IDBA-UD</code> have their own preferences for how sequence data is provided to them. To begin, we will look at the types of data accepted by <code>SPAdes</code>:</p>
<div class="admonition terminal-2">
<p class="admonition-title">Navigate to working directory</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nb">cd</span><span class="w"> </span>/nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR<span class="w"> </span>FOLDER&gt;/3.assembly
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Remember to update <code>&lt;YOUR FOLDER&gt;</code> to your own folder</p>
</div>
<div class="admonition terminal-2">
<p class="admonition-title">Load <code>SPAdes</code> and check parameters</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># Load module</span>
<a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>module<span class="w"> </span>purge
<a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>module<span class="w"> </span>load<span class="w"> </span>SPAdes/3.15.4-gimkl-2022a-Python-3.10.5
<a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a>
<a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="c1"># Check parameters</span>
<a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a>spades.py<span class="w"> </span>-h
</code></pre></div>
</div>
<details class="circle-check">
<summary><code>SPAdes</code> parameters</summary>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>...
<a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>Input data:
<a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>  --12 &lt;filename&gt;             file with interlaced forward and reverse paired-end reads
<a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>  -1 &lt;filename&gt;               file with forward paired-end reads
<a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>  -2 &lt;filename&gt;               file with reverse paired-end reads
<a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>  -s &lt;filename&gt;               file with unpaired reads
<a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>  --merged &lt;filename&gt;         file with merged forward and reverse paired-end reads
<a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>  --pe-12 &lt;#&gt; &lt;filename&gt;      file with interlaced reads for paired-end library number &lt;#&gt;.
<a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>                              Older deprecated syntax is -pe&lt;#&gt;-12 &lt;filename&gt;
<a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>  --pe-1 &lt;#&gt; &lt;filename&gt;       file with forward reads for paired-end library number &lt;#&gt;.
<a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>                              Older deprecated syntax is -pe&lt;#&gt;-1 &lt;filename&gt;
<a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>  --pe-2 &lt;#&gt; &lt;filename&gt;       file with reverse reads for paired-end library number &lt;#&gt;.
<a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>                              Older deprecated syntax is -pe&lt;#&gt;-2 &lt;filename&gt;
<a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>  --pe-s &lt;#&gt; &lt;filename&gt;       file with unpaired reads for paired-end library number &lt;#&gt;.
<a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>                              Older deprecated syntax is -pe&lt;#&gt;-s &lt;filename&gt;
<a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>  --pe-m &lt;#&gt; &lt;filename&gt;       file with merged reads for paired-end library number &lt;#&gt;.
<a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>                              Older deprecated syntax is -pe&lt;#&gt;-m &lt;filename&gt;
<a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>  --pe-or &lt;#&gt; &lt;or&gt;            orientation of reads for paired-end library number &lt;#&gt;
<a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a>                              (&lt;or&gt; = fr, rf, ff).
<a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a>                              Older deprecated syntax is -pe&lt;#&gt;-&lt;or&gt;
<a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a>  --s &lt;#&gt; &lt;filename&gt;          file with unpaired reads for single reads library number &lt;#&gt;.
<a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>                              Older deprecated syntax is --s&lt;#&gt; &lt;filename&gt;
<a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a>  --mp-12 &lt;#&gt; &lt;filename&gt;      file with interlaced reads for mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a>                              Older deprecated syntax is -mp&lt;#&gt;-12 &lt;filename&gt;
<a href="#__codelineno-2-25" id="__codelineno-2-25" name="__codelineno-2-25"></a>  --mp-1 &lt;#&gt; &lt;filename&gt;       file with forward reads for mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-26" id="__codelineno-2-26" name="__codelineno-2-26"></a>                              Older deprecated syntax is -mp&lt;#&gt;-1 &lt;filename&gt;
<a href="#__codelineno-2-27" id="__codelineno-2-27" name="__codelineno-2-27"></a>  --mp-2 &lt;#&gt; &lt;filename&gt;       file with reverse reads for mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-28" id="__codelineno-2-28" name="__codelineno-2-28"></a>                              Older deprecated syntax is -mp&lt;#&gt;-2 &lt;filename&gt;
<a href="#__codelineno-2-29" id="__codelineno-2-29" name="__codelineno-2-29"></a>  --mp-s &lt;#&gt; &lt;filename&gt;       file with unpaired reads for mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-30" id="__codelineno-2-30" name="__codelineno-2-30"></a>                              Older deprecated syntax is -mp&lt;#&gt;-s &lt;filename&gt;
<a href="#__codelineno-2-31" id="__codelineno-2-31" name="__codelineno-2-31"></a>  --mp-or &lt;#&gt; &lt;or&gt;            orientation of reads for mate-pair library number &lt;#&gt;
<a href="#__codelineno-2-32" id="__codelineno-2-32" name="__codelineno-2-32"></a>                              (&lt;or&gt; = fr, rf, ff).
<a href="#__codelineno-2-33" id="__codelineno-2-33" name="__codelineno-2-33"></a>                              Older deprecated syntax is -mp&lt;#&gt;-&lt;or&gt;
<a href="#__codelineno-2-34" id="__codelineno-2-34" name="__codelineno-2-34"></a>  --hqmp-12 &lt;#&gt; &lt;filename&gt;    file with interlaced reads for high-quality mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-35" id="__codelineno-2-35" name="__codelineno-2-35"></a>                              Older deprecated syntax is -hqmp&lt;#&gt;-12 &lt;filename&gt;
<a href="#__codelineno-2-36" id="__codelineno-2-36" name="__codelineno-2-36"></a>  --hqmp-1 &lt;#&gt; &lt;filename&gt;     file with forward reads for high-quality mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-37" id="__codelineno-2-37" name="__codelineno-2-37"></a>                              Older deprecated syntax is -hqmp&lt;#&gt;-1 &lt;filename&gt;
<a href="#__codelineno-2-38" id="__codelineno-2-38" name="__codelineno-2-38"></a>  --hqmp-2 &lt;#&gt; &lt;filename&gt;     file with reverse reads for high-quality mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-39" id="__codelineno-2-39" name="__codelineno-2-39"></a>                              Older deprecated syntax is -hqmp&lt;#&gt;-2 &lt;filename&gt;
<a href="#__codelineno-2-40" id="__codelineno-2-40" name="__codelineno-2-40"></a>  --hqmp-s &lt;#&gt; &lt;filename&gt;     file with unpaired reads for high-quality mate-pair library number &lt;#&gt;.
<a href="#__codelineno-2-41" id="__codelineno-2-41" name="__codelineno-2-41"></a>                              Older deprecated syntax is -hqmp&lt;#&gt;-s &lt;filename&gt;
<a href="#__codelineno-2-42" id="__codelineno-2-42" name="__codelineno-2-42"></a>  --hqmp-or &lt;#&gt; &lt;or&gt;          orientation of reads for high-quality mate-pair library number &lt;#&gt;
<a href="#__codelineno-2-43" id="__codelineno-2-43" name="__codelineno-2-43"></a>                              (&lt;or&gt; = fr, rf, ff).
<a href="#__codelineno-2-44" id="__codelineno-2-44" name="__codelineno-2-44"></a>                              Older deprecated syntax is -hqmp&lt;#&gt;-&lt;or&gt;
<a href="#__codelineno-2-45" id="__codelineno-2-45" name="__codelineno-2-45"></a>  --sanger &lt;filename&gt;         file with Sanger reads
<a href="#__codelineno-2-46" id="__codelineno-2-46" name="__codelineno-2-46"></a>  --pacbio &lt;filename&gt;         file with PacBio reads
<a href="#__codelineno-2-47" id="__codelineno-2-47" name="__codelineno-2-47"></a>  --nanopore &lt;filename&gt;       file with Nanopore reads
<a href="#__codelineno-2-48" id="__codelineno-2-48" name="__codelineno-2-48"></a>  --trusted-contigs &lt;filename&gt;
<a href="#__codelineno-2-49" id="__codelineno-2-49" name="__codelineno-2-49"></a>                              file with trusted contigs
<a href="#__codelineno-2-50" id="__codelineno-2-50" name="__codelineno-2-50"></a>  --untrusted-contigs &lt;filename&gt;
<a href="#__codelineno-2-51" id="__codelineno-2-51" name="__codelineno-2-51"></a>                              file with untrusted contigs
<a href="#__codelineno-2-52" id="__codelineno-2-52" name="__codelineno-2-52"></a>...
</code></pre></div>
</details>
<p>At a glance, you could provide any of the following data types to <code>SPAdes</code> and have it perform an assembly:</p>
<ol>
<li>Illumina paired-end sequencing data, either as standard library or Mate Pairs</li>
<li>Sanger sequences</li>
<li>PacBio reads</li>
<li>Oxford Nanopore reads</li>
<li>Pre-assembled scaffolds for guiding the assembly</li>
</ol>
<p>Awkwardly, while <code>SPAdes</code> accepts multiple input libraries (i.e. samples) in a single assembly, this behaviour does not work with the <code>-meta</code> flag enabled, which is needed in our example to activate metagenome assembly mode. We therefore need to concatenate our four individual samples together ready for sequencing.</p>
<div class="admonition terminal-2">
<p class="admonition-title">Concatenate samples by read direction</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a>cat<span class="w"> </span>sample1_R1.fastq.gz<span class="w"> </span>sample2_R1.fastq.gz<span class="w"> </span>sample3_R1.fastq.gz<span class="w"> </span>sample4_R1.fastq.gz<span class="w"> </span>&gt;<span class="w"> </span>for_spades_R1.fq.gz
<a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>cat<span class="w"> </span>sample1_R2.fastq.gz<span class="w"> </span>sample2_R2.fastq.gz<span class="w"> </span>sample3_R2.fastq.gz<span class="w"> </span>sample4_R2.fastq.gz<span class="w"> </span>&gt;<span class="w"> </span>for_spades_R2.fq.gz
</code></pre></div>
</div>
<p>Note that these FASTQ files are compressed, yet we can concatenate them together with the <code>cat</code> command regardless. This is a nice feature of <code>.gz</code> files that is handy to remember.</p>
<p>By contrast, what does <code>IDBA-UD</code> accept?</p>
<div class="admonition terminal-2">
<p class="admonition-title">Load <code>IDBA-UD</code> and check parameters</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># Load module</span>
<a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a>module<span class="w"> </span>purge
<a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a>module<span class="w"> </span>load<span class="w"> </span>IDBA-UD/1.1.3-GCC-11.3.0
<a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>
<a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="c1"># Check parameters</span>
<a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>idba_ud<span class="w"> </span>--help
</code></pre></div>
</div>
<details class="circle-check">
<summary><code>IDBA-UD</code> parameters</summary>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a>  -o, --out arg (=out)                   output directory
<a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a>  -r, --read arg                         fasta read file (&lt;=128)
<a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a>      --read_level_2 arg                 paired-end reads fasta for second level scaffolds
<a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a>      --read_level_3 arg                 paired-end reads fasta for third level scaffolds
<a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a>      --read_level_4 arg                 paired-end reads fasta for fourth level scaffolds
<a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a>      --read_level_5 arg                 paired-end reads fasta for fifth level scaffolds
<a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a>  -l, --long_read arg                    fasta long read file (&gt;128)
<a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>      --mink arg (=20)                   minimum k value (&lt;=124)
<a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a>      --maxk arg (=100)                  maximum k value (&lt;=124)
<a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a>      --step arg (=20)                   increment of k-mer of each iteration
<a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a>      --inner_mink arg (=10)             inner minimum k value
<a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a>      --inner_step arg (=5)              inner increment of k-mer
<a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a>      --prefix arg (=3)                  prefix length used to build sub k-mer table
<a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a>      --min_count arg (=2)               minimum multiplicity for filtering k-mer when building the graph
<a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a>      --min_support arg (=1)             minimum supoort in each iteration
<a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a>      --num_threads arg (=0)             number of threads
<a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>      --seed_kmer arg (=30)              seed kmer size for alignment
<a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a>      --min_contig arg (=200)            minimum size of contig
<a href="#__codelineno-5-19" id="__codelineno-5-19" name="__codelineno-5-19"></a>      --similar arg (=0.95)              similarity for alignment
<a href="#__codelineno-5-20" id="__codelineno-5-20" name="__codelineno-5-20"></a>      --max_mismatch arg (=3)            max mismatch of error correction
<a href="#__codelineno-5-21" id="__codelineno-5-21" name="__codelineno-5-21"></a>      --min_pairs arg (=3)               minimum number of pairs
<a href="#__codelineno-5-22" id="__codelineno-5-22" name="__codelineno-5-22"></a>      --no_bubble                        do not merge bubble
<a href="#__codelineno-5-23" id="__codelineno-5-23" name="__codelineno-5-23"></a>      --no_local                         do not use local assembly
<a href="#__codelineno-5-24" id="__codelineno-5-24" name="__codelineno-5-24"></a>      --no_coverage                      do not iterate on coverage
<a href="#__codelineno-5-25" id="__codelineno-5-25" name="__codelineno-5-25"></a>      --no_correct                       do not do correction
<a href="#__codelineno-5-26" id="__codelineno-5-26" name="__codelineno-5-26"></a>      --pre_correction                   perform pre-correction before assembly
</code></pre></div>
</details>
<p>'Short' or 'long' reads, and only a single file for each. This means that if we want to assemble our community data using <code>IDBA-UD</code> we will need to pool the paired-end data into a single, interleaved FASTA file. Interleaved means that instead of having a pair of files that contain the separate forward and reverse sequences, the read pairs are in a single file in alternating order. For example</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1"># Paired-end file, forward</span>
<a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>&gt;read1_1
<a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a>...
<a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>&gt;read2_1
<a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a>...
<a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a>
<a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="c1"># Paired-end file, reverse</span>
<a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>&gt;read1_2
<a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a>...
<a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a>&gt;read2_2
<a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a>...
<a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a>
<a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="c1"># Interleaved file</span>
<a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a>&gt;read1_1
<a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a>...
<a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a>&gt;read1_2
<a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a>...
<a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a>&gt;read2_1
<a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a>...
<a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a>&gt;read2_2
<a href="#__codelineno-6-21" id="__codelineno-6-21" name="__codelineno-6-21"></a>...
</code></pre></div>
<p>Fortunately, the <code>IDBA</code> set of tools comes with some helper scripts to achieve just this. Unfortunately we cannot apply this shuffling operation to compressed data, so we must decompress the data first.</p>
<div class="admonition terminal-2">
<p class="admonition-title">Decompress, interleave, and then concatenate sequence files</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>module<span class="w"> </span>load<span class="w"> </span>pigz/2.7
<a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
<a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span>sample1<span class="w"> </span>sample2<span class="w"> </span>sample3<span class="w"> </span>sample4<span class="p">;</span>
<a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="k">do</span>
<a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">  </span>pigz<span class="w"> </span>--keep<span class="w"> </span>--decompress<span class="w"> </span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_R1.fastq.gz<span class="w"> </span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_R2.fastq.gz
<a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">  </span>fq2fa<span class="w"> </span>--merge<span class="w"> </span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_R1.fastq<span class="w"> </span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>_R2.fastq<span class="w"> </span><span class="si">${</span><span class="nv">i</span><span class="si">}</span>.fna
<a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="k">done</span>
<a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a>
<a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>cat<span class="w"> </span>sample1.fna<span class="w"> </span>sample2.fna<span class="w"> </span>sample3.fna<span class="w"> </span>sample4.fna<span class="w"> </span>&gt;<span class="w"> </span>for_idba.fna<span class="w">    </span>
</code></pre></div>
</div>
<hr/>
<h2 id="basic-assembly-parameters">Basic assembly parameters<a class="headerlink" href="#basic-assembly-parameters" title="Permanent link">¶</a></h2>
<p>For any assembler, there are a <strong><em>lot</em></strong> of parameters that can be fine-tuned depending on your data. As no two data sets are the same, it is almost impossible to predict which parameter combinations will yield the best outcome for your dataset. That said, an assembly can be quite a resource-intensive process and it is generally not practical to test every permutation of parameter values with your data. In genomics, the saying goes that the best assembly is the one that answers your question. As long as the data you are receiving is meaningful to the hypothesis you are seeking to address, then your assembly is as good as it needs to be.</p>
<p>Generally speaking, assemblers are developed in a way where they run with default parameters that have been empirically demonstrated to produce the best outcome <strong><em>on average</em></strong> across multiple data sets. For most purposes, there is not a lot of need to change these, but some parameters that we would always want to look at include:</p>
<div class="admonition quote">
<ol>
<li><em>k</em>-mer sizes to be assembled over, and step size if using a range</li>
<li>Number of threads to use during assembly</li>
<li>Memory limit to prevent the assembler from using up all available RAM and forcing the computer to use its <a href="https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-swapspace.html">swap space</a></li>
</ol>
</div>
<h3 id="setting-the-k-mer-size">Setting the <em>k</em>-mer size<a class="headerlink" href="#setting-the-k-mer-size" title="Permanent link">¶</a></h3>
<p>Depending on which assembler you are using, the commands for choosing the <em>k</em>-mer sizes for the assembly vary slightly, but they are recognisable between programs. In <code>SPAdes</code>, you can set the <em>k</em>-mer size using either</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>spades.py<span class="w"> </span>-k<span class="w"> </span><span class="m">21</span>,33,55,77,99,121<span class="w"> </span>...
<a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>
<a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>spades.py<span class="w"> </span>-k<span class="w"> </span>auto<span class="w"> </span>...
</code></pre></div>
</div>
<p>The first command lets us specify the <em>k</em>-mers ourselves, or we are letting <code>SPAdes</code> automatically pick the most appropriate size. For <code>IDBA-UD</code>, we can select the <em>k</em>-mer size using</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a>idba_ud<span class="w"> </span>--mink<span class="w"> </span><span class="m">21</span><span class="w"> </span>--maxk<span class="w"> </span><span class="m">121</span><span class="w"> </span>--step<span class="w"> </span><span class="m">22</span>
</code></pre></div>
</div>
<p>Unlike <code>SPAdes</code>, we do not have fine-scale control over the <em>k</em>-mer sizes used in the assembly. We instead provide <code>IDBA-UD</code> with the first and last <em>k</em>-mer size to use, then specify the increment to use between these. In either case, it is important that we are always assembling using a <em>k</em>-mer of odd lengths in order to avoid the creation of palindromic <em>k</em>-mers.</p>
<h3 id="specifying-the-number-of-threads">Specifying the number of threads<a class="headerlink" href="#specifying-the-number-of-threads" title="Permanent link">¶</a></h3>
<p>This is simple in either assembler:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a>spades.py<span class="w"> </span>-t<span class="w"> </span><span class="m">20</span><span class="w"> </span>...
<a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a>
<a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a>idba_ud<span class="w"> </span>--num_threads<span class="w"> </span><span class="m">20</span><span class="w"> </span>...
</code></pre></div>
</div>
<p>The only thing to keep in mind is that these tools have different default behaviour. If no thread count is specified by the user, <code>SPAdes</code> will assemble with 16 threads. <code>IDBA-UD</code> will use all available threads, which can be problematic if you are using a shared compute environment that does not use a resource management system like slurm.</p>
<h3 id="setting-a-memory-limit">Setting a memory limit<a class="headerlink" href="#setting-a-memory-limit" title="Permanent link">¶</a></h3>
<p>By far, the worst feature of <code>SPAdes</code> is the high memory requirement for performing an assembly. In the absence of monitoring, <code>SPAdes</code> will request more and more memory as it proceeds. If this requires more memory than is available on your computer, your system will start to store memory to disk space. This is an extremely slow operation and can render your computer effectively unusable. In managed environments such as NeSI a memory limit is imposed upon all running jobs, but if you are not using such a system you are advised to set a memory limit when executing <code>SPAdes</code>:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a>spades.py<span class="w"> </span>-m<span class="w"> </span>400GB<span class="w"> </span>...
</code></pre></div>
</div>
<p>No such parameter exists in <code>IDBA-UD</code>, but it requires far less RAM than <code>SPAdes</code>, so you are less likely to need it.</p>
<hr/>
<h2 id="preparing-an-assembly-job-for-slurm">Preparing an assembly job for slurm<a class="headerlink" href="#preparing-an-assembly-job-for-slurm" title="Permanent link">¶</a></h2>
<p>NeSI does not allow users to execute large jobs interactively on the terminal. Instead, the node that we have logged in to (<em>lander02</em>) has only a small fraction of the computing resources that NeSI houses. The <em>lander</em> node is used to write small command scripts, which are then deployed to the large compute nodes by a system called <strong>slurm</strong>. The ins and outs of working in slurm are well beyond the scope of this workshop (and may not be relevant if your institution uses a different resource allocation system). In this workshop, we will therefore only be showing you how to write minimal slurm scripts sufficient to achieve our goals. By the end of the workshop, you should have built up a small collection of slurm scripts for performing the necessary stages of our workflow and with experience you will be able to modify these to suit your own needs.</p>
<h3 id="submitting-a-spades-job-to-nesi-using-slurm">Submitting a <code>SPAdes</code> job to NeSI using slurm<a class="headerlink" href="#submitting-a-spades-job-to-nesi-using-slurm" title="Permanent link">¶</a></h3>
<p>To begin, we need to open a text file using the <code>nano</code> text editor. </p>
<div class="admonition terminal-2">
<p class="admonition-title">Create script named <code>spades_assembly.sl</code> using <code>nano</code></p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a>nano<span class="w"> </span>spades_assembly.sl
</code></pre></div>
</div>
<p>Into this file, either write or copy/paste the following commands:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Paste or type in the following. Remember to update <code>&lt;YOUR FOLDER&gt;</code> to your own directory.</p>
</div>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="ch">#!/bin/bash -e</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="c1">#SBATCH --account       nesi02659      </span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="c1">#SBATCH --job-name      spades_assembly      </span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="c1">#SBATCH --partition     milan</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="c1">#SBATCH --time          00:30:00          </span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="c1">#SBATCH --mem           10G           </span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="c1">#SBATCH --cpus-per-task 12 </span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="c1">#SBATCH --error         %x_%j.err</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="c1">#SBATCH --output        %x_%j.out       </span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="c1"># Load modules</span>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a>module<span class="w"> </span>purge
<a id="__codelineno-13-14" name="__codelineno-13-14"></a>module<span class="w"> </span>load<span class="w"> </span>SPAdes/3.15.4-gimkl-2022a-Python-3.10.5
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>
<a id="__codelineno-13-16" name="__codelineno-13-16"></a><span class="c1"># Working directory</span>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="nb">cd</span><span class="w"> </span>/nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR<span class="w"> </span>FOLDER&gt;/3.assembly
<a id="__codelineno-13-18" name="__codelineno-13-18"></a>
<a id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="c1"># Run SPAdes</span>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a>spades.py<span class="w"> </span>--meta<span class="w"> </span>-k<span class="w"> </span><span class="m">33</span>,55,77,99,121<span class="w"> </span>-t<span class="w"> </span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="w">          </span>-1<span class="w"> </span>for_spades_R1.fq.gz<span class="w"> </span>-2<span class="w"> </span>for_spades_R2.fq.gz<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="w">          </span>-o<span class="w"> </span>spades_assembly/
</code></pre></div></td></tr></table></div>
</div>
<p>To save your file, use <kbd>Ctrl</kbd> + <kbd>O</kbd> to save the file, then <kbd>Ctrl</kbd> + <kbd>X</kbd> to exit <code>nano</code>. Going through those lines one by one:</p>
<details class="abstract">
<summary>Slurm parameters and their functions</summary>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>#!/bin/bash -e</code></td>
<td align="left">Header for the file, letting NeSI know how to interpret the following commands. The <code>-e</code> flag means that the slurm run will halt at the first failed command (rather than pushing through and trying to execute subsequent ones)</td>
</tr>
<tr>
<td align="left"><code>--account</code></td>
<td align="left">The name of the project account to run the job under. You are provided with this when you create a project on NeSI</td>
</tr>
<tr>
<td align="left"><code>--job-name</code></td>
<td align="left">The name of the job, to display when using the <code>squeue</code> command</td>
</tr>
<tr>
<td align="left"><code>--partition</code></td>
<td align="left">This is a parameter that enables us to access the <strong>milan</strong> nodes (think of a node as a single computer within the cluster) where resources are reserved for this workshop</td>
</tr>
<tr>
<td align="left"><code>--time</code></td>
<td align="left">Maximum run time for the job before it is killed</td>
</tr>
<tr>
<td align="left"><code>--mem</code></td>
<td align="left">Amount of server memory to allocate to the job. If this is exceeded, the job will be terminated</td>
</tr>
<tr>
<td align="left"><code>--cpus-per-task</code></td>
<td align="left">number of processing cores to assign to the job. This should match with the number used by your assembler</td>
</tr>
<tr>
<td align="left"><code>--error</code></td>
<td align="left">File to log the <a href="https://en.wikipedia.org/wiki/Standard_streams">standard error</a> stream of the program.<br/>This is typically used to prove error reports, or to just inform the user of job progress</td>
</tr>
<tr>
<td align="left"><code>--output</code></td>
<td align="left">File to log the <a href="https://en.wikipedia.org/wiki/Standard_streams">standard output</a> stream of the program.<br/>This is typically used to inform the user of job progress and supply messages</td>
</tr>
</tbody>
</table>
</details>
<p>The <code>module load</code> command needs to be invoked within your slurm script. It is also a good idea to explicitly set the path to your files within the job so that</p>
<ol>
<li>There is no chance of having the job fail immediately because it cannot find the relevant files</li>
<li>When looking back through your slurm logs, you know where the data is meant to be</li>
</ol>
<div class="admonition abstract">
<p class="admonition-title"><code>SPAdes</code> parameters of note</p>
<table>
<thead>
<tr>
<th align="left">Parameter</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>--meta</code></td>
<td align="left">Activate metagenome assembly mode. Default is to assemble your metagenome using single genome assembly assumptions</td>
</tr>
<tr>
<td align="left"><code>-k</code></td>
<td align="left"><em>k</em>-mer sizes for assembly. These choices will provide the output we will use in the <strong>Binning</strong> session, but feel free to experiment with these to see if you can improve the assembly</td>
</tr>
<tr>
<td align="left"><code>-t</code></td>
<td align="left">Number of threads (see <a href="#specifying-the-number-of-threads">above</a>). Here, we use a special slurm environment variable: <code>$SLURM_CPUS_PER_TASK</code> to tell the programme to use the same number of threads allocated for this job via <code>--cpus-per-task</code>.</td>
</tr>
<tr>
<td align="left"><code>-1</code></td>
<td align="left">Forward reads, matched to their reverse partners</td>
</tr>
<tr>
<td align="left"><code>-2</code></td>
<td align="left">Reverse reads, matched to their forward partners</td>
</tr>
<tr>
<td align="left"><code>-o</code></td>
<td align="left">Output directory for all files</td>
</tr>
</tbody>
</table>
</div>
<p>Note that we also prefix the command (<code>spades.py</code>) with the <code>srun</code> command. This is a command specific to slurm and allows NeSI to track the resource usage of the <code>SPAdes</code> job.</p>
<p>We don't explicitly set memory or thread counts for this job, simply for the sake of keeping the command uncluttered. The default memory limit of <code>SPAdes</code> (250 GB) is much higher than the 10 GB we have allowed our job here. If the memory cap was violated then both slurm and <code>SPAdes</code> will terminate the assembly. We have also left the number of threads at the default value of 16, which matches the number specified in the slurm header.</p>
<p>It is a good idea to match your number of threads request in the slurm script with what you intend to use with <code>SPAdes</code> because your project usage is calculated based off what you request in your slurm scripts rather than what you actually use. Requesting many unused threads simply drives your project down the priority queue. By contrast, requesting fewer threads than you attempt to use in the program (i.e., request 10 in slurm, set thread count to 30 in <code>SPAdes</code>) will result in reduced performance, as your <code>SPAdes</code> job will divide up jobs as though it has 30 threads, but only 10 will be provided. This is discussed <a href="https://www.codeguru.com/cpp/sample_chapter/article.php/c13533/Why-Too-Many-Threads-Hurts-Performance-and-What-to-do-About-It.htm">in this blog post</a>.</p>
<p>Once you are happy with your slurm script, execute the job by navigating to the location of your script and entering the command</p>
<div class="admonition terminal-2">
<p class="admonition-title">Submitting the slurm script for <code>SPAdes</code> assembly</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a>sbatch<span class="w"> </span>spades_assembly.sl
</code></pre></div>
</div>
<p>You will receive a message telling you the job identifier for your assembly. Record this number, as we will use it in the next exercise.</p>
<h3 id="monitoring-job-progress">Monitoring job progress<a class="headerlink" href="#monitoring-job-progress" title="Permanent link">¶</a></h3>
<p>You can view the status of your current jobs using the command</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a>squeue<span class="w"> </span>--me
</code></pre></div>
</div>
<div class="admonition circle-check">
<p class="admonition-title">Terminal output</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a>JOBID         USER     ACCOUNT   NAME        CPUS MIN_MEM PARTITI START_TIME     TIME_LEFT STATE    NODELIST(REASON)    
<a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a>31491555      jboe440  nesi02659 spawner-jupy   2      4G infill  2022-11-23T1     7:44:17 RUNNING  wbl001              
<a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a>31491999      jboe440  nesi02659 spades_assem  12     10G large   2022-11-23T1       30:00 PENDING  wbn069  
</code></pre></div>
</div>
<p>We can see here that the job has not yet begun, as NeSI is waiting for resources to come available. At this stage the <code>START_TIME</code> is an estimation of when the resources are expected to become available. When they do, the output will change to</p>
<div class="admonition circle-check">
<p class="admonition-title">Terminal output</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a>JOBID<span class="w">         </span>USER<span class="w">     </span>ACCOUNT<span class="w">   </span>NAME<span class="w">        </span>CPUS<span class="w"> </span>MIN_MEM<span class="w"> </span>PARTITI<span class="w"> </span>START_TIME<span class="w">     </span>TIME_LEFT<span class="w"> </span>STATE<span class="w">    </span>NODELIST<span class="o">(</span>REASON<span class="o">)</span><span class="w">    </span>
<a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="m">31491555</span><span class="w">      </span>jboe440<span class="w">  </span>nesi02659<span class="w"> </span>spawner-jupy<span class="w">   </span><span class="m">2</span><span class="w">      </span>4G<span class="w"> </span>infill<span class="w">  </span><span class="m">2022</span>-11-23T1<span class="w">     </span><span class="m">7</span>:44:15<span class="w"> </span>RUNNING<span class="w">  </span>wbl001<span class="w">              </span>
<a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="m">31491999</span><span class="w">      </span>jboe440<span class="w">  </span>nesi02659<span class="w"> </span>spades_assem<span class="w">  </span><span class="m">12</span><span class="w">     </span>10G<span class="w"> </span>large<span class="w">   </span><span class="m">2022</span>-11-23T1<span class="w">       </span><span class="m">29</span>:58<span class="w"> </span>RUNNING<span class="w">  </span>wbn069<span class="w">          </span>
</code></pre></div>
</div>
<p>Which allows us to track how far into our run we are, and see the remaining time for the job. The <code>START_TIME</code> column now reports the time the job actually began.</p>
<h3 id="submitting-an-idba-ud-job-to-nesi-using-slurm">Submitting an <code>IDBA-UD</code> job to NeSI using slurm<a class="headerlink" href="#submitting-an-idba-ud-job-to-nesi-using-slurm" title="Permanent link">¶</a></h3>
<div class="admonition terminal-2">
<p class="admonition-title">Create a new slurm script using <code>nano</code> to run an equivalent assembly with <code>IDBA-UD</code></p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a>nano<span class="w"> </span>idbaud_assembly.sl
</code></pre></div>
</div>
<p>Paste or type in the following:</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="ch">#!/bin/bash -e</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="c1">#SBATCH --account       nesi02659</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="c1">#SBATCH --job-name      idbaud_assembly</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="c1">#SBATCH --partition     milan</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="c1">#SBATCH --time          00:20:00</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="c1">#SBATCH --mem           4GB</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="c1">#SBATCH --cpus-per-task 12</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="c1">#SBATCH --error         %x_%j.err</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="c1">#SBATCH --output        %x_%j.out</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="c1"># Prepare modules</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a>module<span class="w"> </span>purge
<a id="__codelineno-19-14" name="__codelineno-19-14"></a>module<span class="w"> </span>load<span class="w"> </span>IDBA-UD/1.1.3-GCC-11.3.0
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="c1"># Working directory</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="nb">cd</span><span class="w"> </span>/nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR<span class="w"> </span>FOLDER&gt;/3.assembly
<a id="__codelineno-19-18" name="__codelineno-19-18"></a>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="c1"># Run IDBA-UD</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a>idba_ud<span class="w"> </span>--num_threads<span class="w"> </span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>--mink<span class="w"> </span><span class="m">33</span><span class="w"> </span>--maxk<span class="w"> </span><span class="m">99</span><span class="w"> </span>--step<span class="w"> </span><span class="m">22</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-19-21" name="__codelineno-19-21"></a><span class="w">        </span>-r<span class="w"> </span>for_idba.fna<span class="w"> </span>-o<span class="w"> </span>idbaud_assembly/
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition terminal-2">
<p class="admonition-title">Submit the script as a slurm job</p>
<div class="highlight"><pre><span></span><code><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a>sbatch<span class="w"> </span>idbaud_assembly.sl
</code></pre></div>
</div>
<p>When your job starts running, files with suffixes <code>.err</code> and <code>.out</code> will be created in the directory from where you submitted your job. These files will have have your job name and job identification number as file names.</p>
<hr/>
</article>
</div>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            Back to top
          </button>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>