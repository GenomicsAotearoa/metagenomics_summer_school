
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Genomics Aotearoa & NeSI">
      
      
        <link rel="canonical" href="https://genomicsaotearoa.github.io/metagenomics_summer_school/day3/ex13_gene_annotation_part1/">
      
      
        <link rel="prev" href="../ex12_gene_prediction/">
      
      
        <link rel="next" href="../ex14_gene_annotation_part2/">
      
      
      <link rel="icon" href="../../theme_images/nesi_ga.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.34">
    
    
      
        <title>Gene annotation I: BLAST-like and HMM - Metagenomics Summer School</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35f28582.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Mukta";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gene-annotation-i-blast-like-and-hmm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Metagenomics Summer School" class="md-header__button md-logo" aria-label="Metagenomics Summer School" data-md-component="logo">
      
  <img src="../../theme_images/nesi_ga.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Metagenomics Summer School
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Gene annotation I: BLAST-like and HMM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/GenomicsAotearoa/metagenomics_summer_school" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GenomicsAotearoa/metagenomics_summer_school
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../day1/ex1_bash_and_scheduler/" class="md-tabs__link">
          
  
  Day 1

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../day2/ex6_initial_binning/" class="md-tabs__link">
          
  
  Day 2

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ex11_coverage_and_taxonomy/" class="md-tabs__link">
          
  
  Day 3

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../day4/ex15_gene_annotation_part3/" class="md-tabs__link">
          
  
  Day 4

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../resources/1_APPENDIX_ex8_Dereplication/" class="md-tabs__link">
          
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../supplementary/supplementary_1/" class="md-tabs__link">
          
  
  Supplementary

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Metagenomics Summer School" class="md-nav__button md-logo" aria-label="Metagenomics Summer School" data-md-component="logo">
      
  <img src="../../theme_images/nesi_ga.png" alt="logo">

    </a>
    Metagenomics Summer School
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/GenomicsAotearoa/metagenomics_summer_school" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GenomicsAotearoa/metagenomics_summer_school
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Day 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Day 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/ex1_bash_and_scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction I: Shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/ex2_1_intro_to_scheduler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction II: HPC and job scheduler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/ex2_quality_filtering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter raw reads by quality
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/ex3_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assembly I: Assembling contigs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/ex4_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assembly II: Varying the parameters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day1/ex5_evaluating_assemblies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assembly evaluation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Day 2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Day 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/ex6_initial_binning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to binning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/ex7_initial_binning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binning with multiple tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/ex8_bin_dereplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bin dereplication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/ex9_refining_bins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manual bin refinement
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day2/ex10.1_viruses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identifying viral contigs in metagenomic data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Day 3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Day 3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ex11_coverage_and_taxonomy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assigning taxonomy to refined prokaryotic bins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ex11.1_phylogenomics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phylogenomics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ex10.2_viruses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virus taxonomy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ex12_gene_prediction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gene prediction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Gene annotation I: BLAST-like and HMM
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Gene annotation I: BLAST-like and HMM
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#annotation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Annotation methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Annotation methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blast-like-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      BLAST-like annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hmm-profiling-of-domains" class="md-nav__link">
    <span class="md-ellipsis">
      HMM-profiling of domains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotating-mags-against-the-uniprot-database-with-diamond" class="md-nav__link">
    <span class="md-ellipsis">
      Annotating MAGs against the UniProt database with DIAMOND
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotating-mags-against-the-pfam-database-with-hmmer" class="md-nav__link">
    <span class="md-ellipsis">
      Annotating MAGs against the Pfam database with HMMER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotating-signal-peptides-of-predicted-genes-using-signalp6" class="md-nav__link">
    <span class="md-ellipsis">
      Annotating signal peptides of predicted genes using SignalP6
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluating-the-quality-of-gene-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluating the quality of gene assignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#differences-in-taxonomies" class="md-nav__link">
    <span class="md-ellipsis">
      Differences in taxonomies
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ex14_gene_annotation_part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gene annotation II: DRAM and coverage calculation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Day 4
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Day 4
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex15_gene_annotation_part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gene annotation III: DRAM distillation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex16a_data_presentation_Intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction to data presentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex16b_data_presentation_Coverage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coverage heatmaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex16c_OPTIONAL_data_presentation_Ordination/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ordinations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex16d_data_presentation_KEGG_pathways/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KEGG pathway maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex16e_data_presentation_Gene_synteny/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gene synteny
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../day4/ex16f_OPTIONAL_data_presentation_CAZy_annotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CAZy heatmaps
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/1_APPENDIX_ex8_Dereplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPENDIX (ex8): Dereplicating data from multiple assemblies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/2_APPENDIX_ex9_Generating_input_files_for_VizBin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPENDIX (ex9): Generating input files for VizBin from DAS_Tool curated bins
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/3_APPENDIX_ex11_Normalise_coverage_example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPENDIX (ex11): Normalise per-sample coverage values by average library size (example)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/4_APPENDIX_ex11_viral_taxonomy_prediction_via_vContact2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    APPENDIX (ex11) : Viral taxonomy prediction via vContact2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/7_command_line_shortcuts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful command line shortcuts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Supplementary
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Supplementary
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../supplementary/supplementary_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NeSI Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../supplementary/supplementary_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NeSI File system, Working directory and Symlinks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#annotation-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Annotation methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Annotation methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blast-like-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      BLAST-like annotation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hmm-profiling-of-domains" class="md-nav__link">
    <span class="md-ellipsis">
      HMM-profiling of domains
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotating-mags-against-the-uniprot-database-with-diamond" class="md-nav__link">
    <span class="md-ellipsis">
      Annotating MAGs against the UniProt database with DIAMOND
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotating-mags-against-the-pfam-database-with-hmmer" class="md-nav__link">
    <span class="md-ellipsis">
      Annotating MAGs against the Pfam database with HMMER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#annotating-signal-peptides-of-predicted-genes-using-signalp6" class="md-nav__link">
    <span class="md-ellipsis">
      Annotating signal peptides of predicted genes using SignalP6
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#evaluating-the-quality-of-gene-assignment" class="md-nav__link">
    <span class="md-ellipsis">
      Evaluating the quality of gene assignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#differences-in-taxonomies" class="md-nav__link">
    <span class="md-ellipsis">
      Differences in taxonomies
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="gene-annotation-i-blast-like-and-hmm">Gene annotation I: BLAST-like and HMM<a class="headerlink" href="#gene-annotation-i-blast-like-and-hmm" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">Objectives</p>
<ul>
<li><a href="#annotation-methods">Annotation methods</a></li>
<li><a href="#annotating-mags-against-the-uniprot-database-with-diamond">Annotating MAGs against the <em>UniProt</em> database with <code>DIAMOND</code></a></li>
<li><a href="#annotating-mags-against-the-pfam-database-with-hmmer">Annotating MAGs against the <em>Pfam</em> database with <code>HMMER</code></a></li>
<li><a href="#annotating-signal-peptides-of-predicted-genes-using-signalp6">Annotating signal peptides with <code>SignalP6</code></a></li>
<li><a href="#evaluating-the-quality-of-gene-assignment">Evaluating the quality of gene assignment</a></li>
<li><a href="#differences-in-taxonomies">Differences in taxonomies</a></li>
</ul>
</div>
<hr />
<h2 id="annotation-methods">Annotation methods<a class="headerlink" href="#annotation-methods" title="Permanent link">&para;</a></h2>
<p>Broadly speaking, there are two ways we perform gene annotations with protein sequences. Both compare our sequences of interest against a curated set of protein sequences for which function is known, or is strongly suspected. In each case, there are particular strengths to the approach and for particular research questions, one option may be favoured over another.</p>
<h3 id="blast-like-annotation"><code>BLAST</code>-like annotation<a class="headerlink" href="#blast-like-annotation" title="Permanent link">&para;</a></h3>
<p>The first of these is the <code>BLAST</code> algorithm for sequence alignment. This approach performs pairwise alignment between the gene of interest (query sequence) and the sequences in the database (target sequence). <code>BLAST</code> searches each potential target sequence for <em>k</em>-mers identified in the query sequence. Where these <em>k</em>-mers are found in targets, the ends are extended out to try to create longer regions of highly similar sequence spans. Across this span, the tool identifies the longest span of characters (nucleotide or amino acid) that match within a scoring framework to return the length of the region (coverage) and the sequence identity over the span (identity).</p>
<p>The original tool for performing this kind of analysis was the <code>BLAST</code> tool. While <code>BLAST</code> and its variants are still excellent tools for performing this kind of sequence annotation, they suffer from a slow runtime speed due to the need to test each query sequence against every target sequence in the database. For this reason, several tools have been published which take the basic approach of <code>BLAST</code>, but augment it with methods to reduce the number of pairwise comparisons needed to identify targets with high sequence similarity to the query. Two popular pieces of software are the tools <a href="http://www.drive5.com/usearch/"><code>USEARCH</code></a> and <a href="https://github.com/bbuchfink/diamond"><code>DIAMOND</code></a>.</p>
<h3 id="hmm-profiling-of-domains">HMM-profiling of domains<a class="headerlink" href="#hmm-profiling-of-domains" title="Permanent link">&para;</a></h3>
<p>An alternate method for attributing function to query sequences is to consider them as a collection of independently functioning protein folding domains. This is the approach used in the <a href="http://hmmer.org/">HMMER</a> software, and the <em>Pfam</em>, <em>TIGRfam</em>, and <em>PANTHER</em> databases. In these analyses, the database consists not of individual sequences, but of Hidden Markov models built from a collection of proteins that share a common domain. These profiles build out a statistical map of the amino acid transitions (from position to position), variations (differences at a position), and insertions/deletions between positions in the domain across the different observations in the training database and apply these maps to the query data.</p>
<p>These exercises will take place in the <code>10.gene_annotation_and_coverage/</code> folder. </p>
<div class="admonition terminal-2">
<p class="admonition-title">Navigate to working directory</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>cd /nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR FOLDER&gt;/10.gene_annotation_and_coverage
</code></pre></div>
</div>
<hr />
<h2 id="annotating-mags-against-the-uniprot-database-with-diamond">Annotating MAGs against the <em>UniProt</em> database with <code>DIAMOND</code><a class="headerlink" href="#annotating-mags-against-the-uniprot-database-with-diamond" title="Permanent link">&para;</a></h2>
<p>For this exercise we are going to use <code>DIAMOND</code> for performing our annotation. We have chosen to use this tool because it is faster than <code>BLAST</code>, and <code>USEARCH</code> comes with licensing restrictions that make it hard to work with in a shared computing environment like NeSI.</p>
<p>For this exercise we have created a diamond-compatible database from the 2024 release of the <em>UniProt</em> database.</p>
<p>For input files, the <code>predictions/</code> results from the previous gene prediction exercise have been copied over to <code>10.gene_annotation_and_coverage/predictions/</code>.</p>
<p>In general, <code>diamond</code> takes a pair of input files - the protein coding sequences we wish to annotate and the database we will use for this purpose. There are a few parameters that need to be tweaked for obtaining a useful output file, however.</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>module<span class="w"> </span>purge
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>module<span class="w"> </span>load<span class="w"> </span>DIAMOND/2.1.6-GCC-11.3.0
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>diamond<span class="w"> </span><span class="nb">help</span>
</code></pre></div>
</div>
<div class="admonition circle-check">
<p class="admonition-title">Terminal output</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>diamond v2.0.15.153 (C) Max Planck Society for the Advancement of Science
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Documentation, support and updates available at http://www.diamondsearch.org
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>Please cite: http://dx.doi.org/10.1038/s41592-021-01101-x Nature Methods (2021)
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>Syntax: diamond COMMAND [OPTIONS]
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>Commands:
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>...
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>blastp  Align amino acid query sequences against a protein reference database
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>...
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>General options:
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>--threads (-p)         number of CPU threads
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>--db (-d)              database file
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>--out (-o)             output file
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>--outfmt (-f)          output format
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>...
</code></pre></div>
</div>
<p>There are two output formats we can chose from which are useful for our analysis. We will obtain our output in the BLAST tabular format, which provides the annotation information in a simple-to-parse text file that can be viewed in any text or spreadsheet viewing tool. This will allow us to investigate and evaluate the quality of our annotations. </p>
<p>Awkwardly, <code>DIAMOND</code> does not provide the headers for what the columns in the output table mean. <a href="http://www.metagenomics.wiki/tools/blast/blastn-output-format-6">This table</a> is a handy reference for how to interpret the output.</p>
<p>From here we can view important statistics for each query/target pairing such as the number of identical residues between sequences and the aligned length between query and target.</p>
<p>Before we begin, we need to create an directory for outputs.</p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>gene_annotations
</code></pre></div>
</div>
<p>Now, lets set up a slurm job to annotate each of our MAGs. </p>
<p>Create a new script</p>
<div class="admonition terminal-2">
<p class="admonition-title">Create script named <code>annotate_uniprot.sl</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>nano<span class="w"> </span>annotate_uniprot.sl
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Remember to update <YOUR FOLDER> to your own folder</p>
</div>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="ch">#!/bin/bash -e</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="c1">#SBATCH --account       nesi02659</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="c1">#SBATCH --job-name      annotate_uniprot</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="c1">#SBATCH --partition     milan</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="c1">#SBATCH --time          01:00:00</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1">#SBATCH --mem           20GB</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="c1">#SBATCH --cpus-per-task 20</span>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="c1">#SBATCH --array         0-9</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1">#SBATCH --error         %x_%A_%a.err</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="c1">#SBATCH --output        %x_%A_%a.out</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="c1"># Load modules</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a>module<span class="w"> </span>purge
<a id="__codelineno-5-15" name="__codelineno-5-15"></a>module<span class="w"> </span>load<span class="w"> </span>DIAMOND/2.1.6-GCC-11.3.0
<a id="__codelineno-5-16" name="__codelineno-5-16"></a>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="c1"># Working directory</span>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="nb">cd</span><span class="w"> </span>/nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR<span class="w"> </span>FOLDER&gt;/10.gene_annotation_and_coverage
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="c1"># Variables</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="nv">prot_file</span><span class="o">=</span>predictions/bin_<span class="si">${</span><span class="nv">SLURM_ARRAY_TASK_ID</span><span class="si">}</span>.genes.no_metadata.faa
<a id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="nv">out_file</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="si">${</span><span class="nv">prot_file</span><span class="si">}</span><span class="w"> </span>.faa<span class="k">)</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="nv">db</span><span class="o">=</span>/nesi/nobackup/nesi02659/MGSS_2024/resources/databases/uniprot.20240724.dmnd
<a id="__codelineno-5-24" name="__codelineno-5-24"></a>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a><span class="c1"># Run DIAMOND</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a>diamond<span class="w"> </span>blastp<span class="w"> </span>--threads<span class="w"> </span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span>--max-target-seqs<span class="w"> </span><span class="m">5</span><span class="w"> </span>--evalue<span class="w"> </span><span class="m">0</span>.001<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="w">               </span>--db<span class="w"> </span><span class="nv">$db</span><span class="w"> </span>--query<span class="w"> </span><span class="si">${</span><span class="nv">prot_file</span><span class="si">}</span><span class="w"> </span>--outfmt<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="w">               </span>--out<span class="w"> </span>gene_annotations/<span class="si">${</span><span class="nv">out_file</span><span class="si">}</span>.uniprot.txt
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition terminal-2">
<p class="admonition-title">Submit the script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>sbatch<span class="w"> </span>annotate_uniprot.sl
</code></pre></div>
</div>
<hr />
<h2 id="annotating-mags-against-the-pfam-database-with-hmmer">Annotating MAGs against the <em>Pfam</em> database with <code>HMMER</code><a class="headerlink" href="#annotating-mags-against-the-pfam-database-with-hmmer" title="Permanent link">&para;</a></h2>
<p>The standard software for performing HMM-profiling annotation is <a href="http://hmmer.org/">HMMER</a>. Compared to <code>BLAST</code>, <code>FASTA</code>, and other sequence alignment and database search tools based on older scoring methodology, <code>HMMER</code> aims to be significantly more accurate and more able to detect remote homologs because of the strength of its underlying mathematical models. In the past, this strength came at significant computational expense, but in the new <code>HMMER3</code> project, <code>HMMER</code> is now essentially as fast as <code>BLAST</code>. </p>
<p><code>HMMER</code> will search one or more profiles against a sequence database for sequence hommologs, and for making sequence alignments, implementing profile hidden Markov models. In this exercise, we will perform a search using <code>hmmsearch</code>. For each profile in <em>hmmfile</em>, <code>HMMER</code> uses that query profile to search the target database of sequences indicated in <em>seqdb</em>, and output ranked lists of the sequences with the most significant matches to the profile. <code>hmmsearch</code> accepts any <em>fastA</em> file as target database input. It also accepts EMBL/UniProtKB text format, and Genbank format. It will automatically determine what format your file is in so you dont have to specify it. </p>
<p>As we did with <code>diamond</code>, we will also have to modify some parameters to get the desired ouotput. </p>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>module<span class="w"> </span>load<span class="w"> </span>HMMER/3.3.2-GCC-11.3.0
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>hmmsearch<span class="w"> </span>-h
</code></pre></div>
</div>
<details class="abstract">
<summary><code>hmmsearch -h</code></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>hmmsearch :: search profile(s) against a sequence database
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>HMMER 3.3.2 (Nov 2020); http://hmmer.org/
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>Copyright (C) 2020 Howard Hughes Medical Institute.
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>Freely distributed under the BSD open source license.
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>Usage: hmmsearch [options] &lt;hmmfile&gt; &lt;seqdb&gt;
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>Basic options:
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a> -h : show brief help on version and usage
<a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>
<a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>Options directing output:
<a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>...
<a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>--tblout &lt;f&gt;     : save parseable table of per-sequence hits to file &lt;f&gt;
<a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>....
<a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>
<a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>Options controlling reporting thresholds:
<a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>...
<a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>-E &lt;x&gt;     : report sequences &lt;= this E-value threshold in output  [10.0]  (x&gt;0)
<a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>...
<a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>
<a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>Other expert options:
<a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>...
<a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>--cpu &lt;n&gt;     : number of parallel CPU workers to use for multithreads
<a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>...
</code></pre></div>
</details>
<p>We are now going to submit another slurm job to annotate our MAGs using the <a href="https://www.ebi.ac.uk/interpro/download/Pfam/">Pfam database</a>. Pfam used to have a standalone website, but it has recently been integrated into InterPro maintained by the European Bioinformatics Institute (see <a href="https://xfam.wordpress.com/2022/08/04/pfam-website-decommission/">announcement</a>). Matching sequences to a <code>Pfam</code> entry allows us to transfer the functional information from an experimentally characterised sequence to uncharacterised sequences in the same entry. <code>Pfam</code> then provides comprehensive annotation for each entry.</p>
<div class="admonition terminal-2">
<p class="admonition-title">Create script named <code>annotate_pfam.sl</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>nano<span class="w"> </span>annotate_pfam.sl
</code></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Remember to update <YOUR FOLDER> to your own folder</p>
</div>
<div class="admonition terminal">
<p class="admonition-title">code</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span>
<span class="normal"><a href="#__codelineno-10-14">14</a></span>
<span class="normal"><a href="#__codelineno-10-15">15</a></span>
<span class="normal"><a href="#__codelineno-10-16">16</a></span>
<span class="normal"><a href="#__codelineno-10-17">17</a></span>
<span class="normal"><a href="#__codelineno-10-18">18</a></span>
<span class="normal"><a href="#__codelineno-10-19">19</a></span>
<span class="normal"><a href="#__codelineno-10-20">20</a></span>
<span class="normal"><a href="#__codelineno-10-21">21</a></span>
<span class="normal"><a href="#__codelineno-10-22">22</a></span>
<span class="normal"><a href="#__codelineno-10-23">23</a></span>
<span class="normal"><a href="#__codelineno-10-24">24</a></span>
<span class="normal"><a href="#__codelineno-10-25">25</a></span>
<span class="normal"><a href="#__codelineno-10-26">26</a></span>
<span class="normal"><a href="#__codelineno-10-27">27</a></span>
<span class="normal"><a href="#__codelineno-10-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="ch">#!/bin/bash -e</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="c1">#SBATCH --account       nesi02659</span>
<a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="c1">#SBATCH --job-name      annotate_pfam</span>
<a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="c1">#SBATCH --partition     milan</span>
<a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="c1">#SBATCH --time          00:20:00</span>
<a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="c1">#SBATCH --mem           5GB</span>
<a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="c1">#SBATCH --cpus-per-task 10</span>
<a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="c1">#SBATCH --array         0-9</span>
<a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="c1">#SBATCH --error         %x_%A_%a.err</span>
<a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="c1">#SBATCH --output        %x_%A_%a.out</span>
<a id="__codelineno-10-12" name="__codelineno-10-12"></a>
<a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="c1"># Load modules</span>
<a id="__codelineno-10-14" name="__codelineno-10-14"></a>module<span class="w"> </span>purge
<a id="__codelineno-10-15" name="__codelineno-10-15"></a>module<span class="w"> </span>load<span class="w"> </span>HMMER/3.3.2-GCC-11.3.0
<a id="__codelineno-10-16" name="__codelineno-10-16"></a>
<a id="__codelineno-10-17" name="__codelineno-10-17"></a><span class="c1"># Working directory</span>
<a id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="nb">cd</span><span class="w"> </span>/nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR<span class="w"> </span>FOLDER&gt;/10.gene_annotation_and_coverage
<a id="__codelineno-10-19" name="__codelineno-10-19"></a>
<a id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="c1"># Variables</span>
<a id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="nv">prot_file</span><span class="o">=</span>predictions/bin_<span class="si">${</span><span class="nv">SLURM_ARRAY_TASK_ID</span><span class="si">}</span>.genes.no_metadata.faa
<a id="__codelineno-10-22" name="__codelineno-10-22"></a><span class="nv">out_file</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="si">${</span><span class="nv">prot_file</span><span class="si">}</span><span class="w"> </span>.faa<span class="k">)</span>
<a id="__codelineno-10-23" name="__codelineno-10-23"></a><span class="nv">db</span><span class="o">=</span>/nesi/nobackup/nesi02659/MGSS_2024/resources/databases/Pfam-A.hmm
<a id="__codelineno-10-24" name="__codelineno-10-24"></a>
<a id="__codelineno-10-25" name="__codelineno-10-25"></a><span class="c1"># Run HMMER</span>
<a id="__codelineno-10-26" name="__codelineno-10-26"></a>hmmsearch<span class="w"> </span>--tblout<span class="w"> </span>gene_annotations/<span class="si">${</span><span class="nv">out_file</span><span class="si">}</span>.pfam.txt<span class="w"> </span>-E<span class="w"> </span><span class="m">0</span>.001<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-27" name="__codelineno-10-27"></a><span class="w">          </span>--cpu<span class="w"> </span><span class="nv">$SLURM_CPUS_PER_TASK</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-10-28" name="__codelineno-10-28"></a><span class="w">          </span><span class="si">${</span><span class="nv">db</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">prot_file</span><span class="si">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition terminal-2">
<p class="admonition-title">Submit the script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>sbatch<span class="w"> </span>annotate_pfam.sl
</code></pre></div>
</div>
<hr />
<h2 id="annotating-signal-peptides-of-predicted-genes-using-signalp6">Annotating signal peptides of predicted genes using <code>SignalP6</code><a class="headerlink" href="#annotating-signal-peptides-of-predicted-genes-using-signalp6" title="Permanent link">&para;</a></h2>
<p>In addition to putative function, we can also predict whether a protein is secreted or not using <code>SignalP</code>. In the 5<sup>th</sup> version, users needed to know the Gram status of the organism for the software to predict signal peptides. In 2022, the developers (<a href="https://www.nature.com/articles/s41587-021-01156-3">Teufel et al., 2022</a>) produced a 6<sup>th</sup> version that uses protein language models (like ChatGPT, for proteins!) to predict the presence of signal peptides across the domains of life.</p>
<p><code>SignalP6</code> has several models depending on required accuracy and hardware availability. Here, we are running the fast model on CPU. There are models built for GPU (they are interconvertible and the software package comes with utilities for easy conversion) that is blazingly fast (most language models require GPUs for accelerations). However, GPUs on NeSI are a coveted resource. For our small dataset, the fast model on CPU is sufficient as an example.</p>
<div class="admonition note">
<p class="admonition-title"><code>SignalP6</code> is licensed software</p>
<p>In terms of computational capability to detect signal peptides, there is nothing like SignalP6. It is free for academic use and other models can be requested from the developers. If you are not running this on NeSI, you will need to acquire your own license.</p>
</div>
<div class="admonition terminal-code">
<p class="admonition-title">code</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>nano<span class="w"> </span>annotate_signal_peptide.sl
</code></pre></div>
</div>
<div class="admonition terminal-code">
<p class="admonition-title">code</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span>
<span class="normal"><a href="#__codelineno-13-13">13</a></span>
<span class="normal"><a href="#__codelineno-13-14">14</a></span>
<span class="normal"><a href="#__codelineno-13-15">15</a></span>
<span class="normal"><a href="#__codelineno-13-16">16</a></span>
<span class="normal"><a href="#__codelineno-13-17">17</a></span>
<span class="normal"><a href="#__codelineno-13-18">18</a></span>
<span class="normal"><a href="#__codelineno-13-19">19</a></span>
<span class="normal"><a href="#__codelineno-13-20">20</a></span>
<span class="normal"><a href="#__codelineno-13-21">21</a></span>
<span class="normal"><a href="#__codelineno-13-22">22</a></span>
<span class="normal"><a href="#__codelineno-13-23">23</a></span>
<span class="normal"><a href="#__codelineno-13-24">24</a></span>
<span class="normal"><a href="#__codelineno-13-25">25</a></span>
<span class="normal"><a href="#__codelineno-13-26">26</a></span>
<span class="normal"><a href="#__codelineno-13-27">27</a></span>
<span class="normal"><a href="#__codelineno-13-28">28</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="ch">#!/bin/bash -e</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="c1">#SBATCH --account       nesi02659</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="c1">#SBATCH --job-name      signal_peptide</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="c1">#SBATCH --partition     milan</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="c1">#SBATCH --time          00:30:00</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="c1">#SBATCH --mem           10GB</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="c1">#SBATCH --cpus-per-task 24</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="c1">#SBATCH --error         %x_%A_%a.err</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a><span class="c1">#SBATCH --output        %x_%A_%a.out</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="c1">#SBATCH --array         0-9</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a>
<a id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="c1"># Load modules</span>
<a id="__codelineno-13-14" name="__codelineno-13-14"></a>module<span class="w"> </span>purge
<a id="__codelineno-13-15" name="__codelineno-13-15"></a>module<span class="w"> </span>load<span class="w"> </span>SignalP/6.0g-gimkl-2022a-Python-3.10.5
<a id="__codelineno-13-16" name="__codelineno-13-16"></a>
<a id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="c1"># Working directory</span>
<a id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="nb">cd</span><span class="w"> </span>/nesi/nobackup/nesi02659/MGSS_U/&lt;YOUR<span class="w"> </span>FOLDER&gt;/10.gene_annotation_and_coverage
<a id="__codelineno-13-19" name="__codelineno-13-19"></a>
<a id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="c1"># Array variables</span>
<a id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="nv">files</span><span class="o">=(</span>predictions/*.faa<span class="o">)</span>
<a id="__codelineno-13-22" name="__codelineno-13-22"></a><span class="nv">bin</span><span class="o">=</span><span class="si">${</span><span class="nv">files</span><span class="p">[</span><span class="nv">$SLURM_ARRAY_TASK_ID</span><span class="p">]</span><span class="si">}</span>
<a id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="nv">prefix</span><span class="o">=</span><span class="k">$(</span>basename<span class="w"> </span><span class="si">${</span><span class="nv">bin</span><span class="si">}</span><span class="w"> </span>genes.no_metadata.faa<span class="k">)</span>
<a id="__codelineno-13-24" name="__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="c1"># Run SignalP</span>
<a id="__codelineno-13-26" name="__codelineno-13-26"></a>signalp6<span class="w"> </span>--fastafile<span class="w"> </span><span class="si">${</span><span class="nv">bin</span><span class="si">}</span><span class="w"> </span>--output_dir<span class="w"> </span>signal_peptides/<span class="si">${</span><span class="nv">prefix</span><span class="si">}</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="w">         </span>--format<span class="w"> </span>none<span class="w"> </span>--organism<span class="w"> </span>other<span class="w"> </span>--bsize<span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="w">         </span>--write_procs<span class="w"> </span><span class="nv">$SLURM_CPUS_PER_TASK</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="admonition warning">
<p class="admonition-title"><code>SignalP</code> will probably <code>TIMEOUT</code></p>
<p>The above script will almost, inevitably, time out before completing every MAG. However, that is not critical for our purposes today. We simply need at least one of the array jobs to complete (several will) for us to explore the output.</p>
</div>
<p>The output of the script above are directories per bin that contain 5 files:</p>
<ul>
<li><code>predicted_results.txt</code> the main output with gene ID and the predicted signal peptide ("Other" means none predicted), the prediction probability (i.e., confidence), and the cleavage site</li>
<li><code>output.gff3</code> A GFF3-format output of sequences with start and end positions of signal peptides relative to each amino acid sequence</li>
<li><code>output.json</code> Similar to above, with more information about run parameters</li>
<li><code>processed_entries.fasta</code> Amino acid sequences with the signal peptide cleaved off (i.e., predicted mature proteins)</li>
<li><code>region_output.gff3</code> Signal peptides have specific regions characteristic of each type of signal peptide. These usually inform us about cleavage sites for those proteins. This output provides this information. </li>
</ul>
<div class="admonition warning">
<p class="admonition-title"><code>--format none</code></p>
<p>If you choose to run the above script with other formats (e.g., txt, png, all), per-sequence data outputs and prediction plots (if requested) will be produced. For large numbers of amino acid sequences, this can be problematic as it uses up a lot of space. Unless you're needing to query specific parts of a few proteins, it is advised to stick to "none" to output summaries only.</p>
</div>
<h2 id="evaluating-the-quality-of-gene-assignment">Evaluating the quality of gene assignment<a class="headerlink" href="#evaluating-the-quality-of-gene-assignment" title="Permanent link">&para;</a></h2>
<p>Determining how trustworthy a gene annotation is can be a very tricky process. How similar do protein sequences need to be to perform the same function? The answer is surprisingly low. A bioinformatic analysis performed in 1999 identified that proteins with as little as 20 - 35% sequence identity can still share the same function (<a href="https://doi.org/10.1093/protein/12.2.85">Rost, 1999</a>), but this is not a universal occurrence. When evaluating annotations, consider the following questions:</p>
<div class="admonition quote">
<ol>
<li>What is the amino acid identity along the aligned region?</li>
<li>What is the amino acid <em>similarity</em> between the aligned region?</li>
<li>What is the coverage as a percentage of the query and target genes?</li>
<li>If we infer a phylogeny of this query gene with references from the target family, is a stable tree resolved?</li>
<li>Does the inclusion of this gene function make sense in the context of the organism's taxonomy?</li>
<li>Does the gene sit on a long contig that is core to the MAG, or is it a short contig carrying only a single gene?</li>
<li>If we are uncertain of a particular annotation, does the predicted gene occur in an operon? If so, are the other genes present in the annotation?</li>
</ol>
</div>
<p>We must also remain aware of the potential for incorrectly annotated genes in the annotation database and that proteins can perform multiple functions (and may therefore be attributed multiple, inconsistent annotations). Furthermore, it is also important to consider exactly which part of the target gene the alignment is happening across. There are several catalytic centers of enzymes, such as the Fe-S cofactor, which are shared across many different proteins, and if your annotation is only spanning one of these regions then it may simply be the case that you are identifying a generic electron accepting or donating domain.</p>
<hr />
<h2 id="differences-in-taxonomies">Differences in taxonomies<a class="headerlink" href="#differences-in-taxonomies" title="Permanent link">&para;</a></h2>
<p>Another way to determine if an annotation 'belongs' in the MAG of interest is to consider the predicted taxonomy of the query gene with that of the MAG itself. For example, if you detect a <em>Desulfovibrio</em>-like <em>dsrA</em> sequence in a bin that has been classified as belonging to the genus <em>Desulfovibrio</em> then it is probably a safe bet that the annotation is correct.</p>
<p>However, when comparing taxonomic assignments, it is important to be aware of the differing taxonomic schemas that are circulating in the microbiological and bioinformatic literature and to know how to reconcile their differences. Similar to how the 16S rRNA gene taxonomies provided by <em>SILVA</em>, <em>Greengenes</em>, and <em>RDP</em> taxonomies all differ in some aspects, there are multiple competing taxonomies in protein databases.</p>
<p>This problem exists despite the existence of a formal <a href="https://www.microbiologyresearch.org/content/journal/ijsem/10.1099/ijsem.0.000778">Code</a> for the naming of bacteria and archaea, because </p>
<div class="admonition quote">
<ol>
<li>There are no rules governing how we define the grouping of these names together, other than for type species</li>
<li>Defunct synonyms and basonyms are not correctly purged from taxonomy lists (this is quite noticeable with the NCBI taxonomy)</li>
<li>Valid names cannot be assigned for uncultivated organisms, meaning there are many informal placeholder names in the literature. For example, clades like WPS-2, SAR324, and SAUL are widely cited in the literature despite having no official standing</li>
</ol>
</div>
<p>It is therefore important to periodically sanity check your taxonomic annotations in order to avoid splitting taxa based on spelling differences or the use of historic names that have since been reclassified.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.sections", "navigation.expand", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.56dfad97.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>